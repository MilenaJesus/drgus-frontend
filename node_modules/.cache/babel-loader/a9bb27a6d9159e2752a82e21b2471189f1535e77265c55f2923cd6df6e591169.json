{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import{useLocation,Link}from'react-router-dom';import axios from'axios';import'./Topo.css';import{useNotificacoes}from'../context/NotificacaoContext';import{formatDistanceToNow}from'date-fns';import ptBR from'date-fns/locale/pt-BR';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL=process.env.REACT_APP_API_BASE_URL;// Mapeamento dos títulos das páginas (ajuste conforme suas rotas)\nconst pageTitles={'/inicio':'Início','/pacientes':'Pacientes','/patients/new':'Novo Paciente',// Ajustado para corresponder à rota\n'/patients/:id':'Detalhes do Paciente',// Mantém o padrão genérico\n'/patients/:id/edit':'Editar Paciente',// Adicionada rota de edição\n'/agenda':'Agenda','/orcamentos':'Orçamentos','/pagamentos':'Pagamentos','/notificacoes':'Notificações'};function Header(){const location=useLocation();// Pega dados e funções do Contexto de Notificações\nconst{unreadCount,fetchUnreadCount,isLoadingCount}=useNotificacoes();// Estados locais para o dropdown\nconst[isDropdownOpen,setIsDropdownOpen]=useState(false);const[recentNotifications,setRecentNotifications]=useState([]);const[isLoadingDropdown,setIsLoadingDropdown]=useState(false);// Ref para o container do dropdown (para detectar cliques fora)\nconst dropdownRef=useRef(null);// Função para buscar as notificações recentes NÃO LIDAS\nconst fetchRecentNotifications=useCallback(async()=>{// Não busca se não houver não lidas ou se já estiver buscando\nif(unreadCount===0||isLoadingDropdown){setRecentNotifications([]);return;}setIsLoadingDropdown(true);const token=localStorage.getItem('access_token');if(!token){setIsLoadingDropdown(false);return;}try{// Busca as X mais recentes não lidas (ex: limit=5)\nconst response=await axios.get(\"\".concat(API_BASE_URL,\"/api/notificacoes/?lida=false&limit=5\"),{headers:{'Authorization':\"Bearer \".concat(token)}});const notificationsData=response.data.results||(Array.isArray(response.data)?response.data:[]);setRecentNotifications(notificationsData);}catch(error){console.error(\"Erro ao buscar notificações recentes:\",error);setRecentNotifications([]);// Limpa em caso de erro\n// Tratar erro 401 (opcional aqui, já tratado no context)\n}finally{setIsLoadingDropdown(false);}},[unreadCount,isLoadingDropdown]);// Adicionado isLoadingDropdown como dependência\n// Função para abrir/fechar o dropdown\nconst toggleDropdown=()=>{const nextState=!isDropdownOpen;setIsDropdownOpen(nextState);// Busca notificações ao abrir (se houver não lidas)\nif(nextState&&unreadCount>0){fetchRecentNotifications();}};// Função para marcar todas como lidas\nconst handleMarkAllRead=async()=>{// Verifica se há algo para marcar\nif(unreadCount===0){setIsDropdownOpen(false);// Fecha o dropdown se já estiver vazio\nreturn;}try{const token=localStorage.getItem('access_token');if(!token)throw new Error(\"Token não encontrado\");// Chama o novo endpoint do backend usando POST\nawait axios.post(\"\".concat(API_BASE_URL,\"/api/notificacoes/marcar-todas-como-lidas/\"),{},// Corpo da requisição vazio, pois a ação não precisa de dados extras\n{headers:{'Authorization':\"Bearer \".concat(token)}});// Após sucesso:\nfetchUnreadCount();// Pede ao Contexto para atualizar a contagem global (deve ir para 0)\nsetRecentNotifications([]);// Limpa a lista local no dropdown\nsetIsDropdownOpen(false);// Fecha o dropdown\n}catch(error){var _error$response;console.error(\"Erro ao marcar todas como lidas:\",((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);alert(\"Erro ao marcar notificações como lidas. Verifique o console.\");// Não fecha o dropdown em caso de erro para o usuário ver\n}};// Efeito para fechar dropdown ao clicar fora\nuseEffect(()=>{const handleClickOutside=event=>{// Verifica se o clique foi fora do elemento referenciado pelo dropdownRef\nif(dropdownRef.current&&!dropdownRef.current.contains(event.target)){setIsDropdownOpen(false);}};if(isDropdownOpen){document.addEventListener('mousedown',handleClickOutside);}else{document.removeEventListener('mousedown',handleClickOutside);}return()=>{// Limpeza ao desmontar\ndocument.removeEventListener('mousedown',handleClickOutside);};},[isDropdownOpen]);// Função para formatar tempo relativo\nconst formatTempoAtras=dateString=>{try{const date=new Date(dateString);return formatDistanceToNow(date,{addSuffix:true,locale:ptBR});}catch(e){console.error(\"Erro formatando data:\",dateString,e);return dateString;}};// Função para pegar o título da página (ajustada para rotas dinâmicas)\nconst getPageTitle=()=>{let title='DrGus';// Título padrão\n// Verifica rotas exatas primeiro\nif(pageTitles[location.pathname]){title=pageTitles[location.pathname];}else{// Verifica rotas com parâmetros (ex: /patients/:id)\nfor(const path in pageTitles){if(path.includes(':')){// Cria uma regex a partir do padrão da rota\n// Ex: /patients/:id vira /patients/[^/]+\nconst regexPath=new RegExp(\"^\".concat(path.replace(/:\\w+/g,'[^/]+'),\"$\"));if(regexPath.test(location.pathname)){title=pageTitles[path];break;// Encontrou, pode parar\n}}}}return title;};const currentPageTitle=getPageTitle();return/*#__PURE__*/_jsxs(\"header\",{className:\"app-header-common\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-title\",children:currentPageTitle}),/*#__PURE__*/_jsxs(\"div\",{className:\"notification-icon-wrapper\",ref:dropdownRef,children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"notification-icon-button\",onClick:toggleDropdown,\"aria-label\":\"Abrir notifica\\xE7\\xF5es\",\"aria-haspopup\":\"true\",\"aria-expanded\":isDropdownOpen,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bx bxs-bell\"}),\" \",!isLoadingCount&&unreadCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"notification-badge\",children:unreadCount>9?'9+':unreadCount})]}),isDropdownOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"notification-dropdown\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-header\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Notifica\\xE7\\xF5es Recentes\"}),!isLoadingDropdown&&recentNotifications.length>0&&/*#__PURE__*/_jsx(\"button\",{onClick:handleMarkAllRead,className:\"mark-all-read-button\",children:\"Marcar todas como lidas\"})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"notification-list\",children:isLoadingDropdown?/*#__PURE__*/_jsx(\"li\",{className:\"notification-item loading\",children:\"Carregando...\"}):recentNotifications.length>0?recentNotifications.map(notif=>/*#__PURE__*/_jsx(\"li\",{className:\"notification-item\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"notification-link\",children:[\" \",/*#__PURE__*/_jsx(\"p\",{className:\"notification-message\",children:notif.mensagem}),/*#__PURE__*/_jsx(\"span\",{className:\"notification-time\",children:formatTempoAtras(notif.data_criacao)})]})},notif.id_notificacao)):/*#__PURE__*/_jsx(\"li\",{className:\"notification-item empty\",children:\"Nenhuma notifica\\xE7\\xE3o nova.\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-footer\",children:/*#__PURE__*/_jsx(Link,{to:\"/notificacoes\",onClick:()=>setIsDropdownOpen(false),children:\"Ver todas as notifica\\xE7\\xF5es\"})})]})]})]});}export default Header;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useLocation","Link","axios","useNotificacoes","formatDistanceToNow","ptBR","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","pageTitles","Header","location","unreadCount","fetchUnreadCount","isLoadingCount","isDropdownOpen","setIsDropdownOpen","recentNotifications","setRecentNotifications","isLoadingDropdown","setIsLoadingDropdown","dropdownRef","fetchRecentNotifications","token","localStorage","getItem","response","get","concat","headers","notificationsData","data","results","Array","isArray","error","console","toggleDropdown","nextState","handleMarkAllRead","Error","post","_error$response","message","alert","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","formatTempoAtras","dateString","date","Date","addSuffix","locale","e","getPageTitle","title","pathname","path","includes","regexPath","RegExp","replace","test","currentPageTitle","className","children","ref","type","onClick","length","map","notif","mensagem","data_criacao","id_notificacao","to"],"sources":["C:/Users/milen/Desktop/4º ano/projeto/ProjetoDrGus/frontend/src/componentes/Topo.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useLocation, Link } from 'react-router-dom';\r\nimport axios from 'axios'; \r\nimport './Topo.css';\r\nimport { useNotificacoes } from '../context/NotificacaoContext'; \r\nimport { formatDistanceToNow } from 'date-fns'; \r\nimport ptBR from 'date-fns/locale/pt-BR'; \r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL;\r\n\r\n// Mapeamento dos títulos das páginas (ajuste conforme suas rotas)\r\nconst pageTitles = {\r\n    '/inicio': 'Início',\r\n    '/pacientes': 'Pacientes',\r\n    '/patients/new': 'Novo Paciente', // Ajustado para corresponder à rota\r\n    '/patients/:id': 'Detalhes do Paciente', // Mantém o padrão genérico\r\n    '/patients/:id/edit': 'Editar Paciente', // Adicionada rota de edição\r\n    '/agenda': 'Agenda',\r\n    '/orcamentos': 'Orçamentos',\r\n    '/pagamentos': 'Pagamentos',\r\n    '/notificacoes': 'Notificações',\r\n};\r\n\r\nfunction Header() {\r\n    const location = useLocation();\r\n    // Pega dados e funções do Contexto de Notificações\r\n    const { unreadCount, fetchUnreadCount, isLoadingCount } = useNotificacoes();\r\n\r\n    // Estados locais para o dropdown\r\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n    const [recentNotifications, setRecentNotifications] = useState([]);\r\n    const [isLoadingDropdown, setIsLoadingDropdown] = useState(false);\r\n\r\n    // Ref para o container do dropdown (para detectar cliques fora)\r\n    const dropdownRef = useRef(null);\r\n\r\n    // Função para buscar as notificações recentes NÃO LIDAS\r\n    const fetchRecentNotifications = useCallback(async () => {\r\n        // Não busca se não houver não lidas ou se já estiver buscando\r\n        if (unreadCount === 0 || isLoadingDropdown) {\r\n            setRecentNotifications([]);\r\n            return;\r\n        }\r\n        setIsLoadingDropdown(true);\r\n        const token = localStorage.getItem('access_token');\r\n        if (!token) { setIsLoadingDropdown(false); return; }\r\n\r\n        try {\r\n            // Busca as X mais recentes não lidas (ex: limit=5)\r\n            const response = await axios.get(`${API_BASE_URL}/api/notificacoes/?lida=false&limit=5`, {\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n            const notificationsData = response.data.results || (Array.isArray(response.data) ? response.data : []);\r\n            setRecentNotifications(notificationsData);\r\n        } catch (error) {\r\n            console.error(\"Erro ao buscar notificações recentes:\", error);\r\n            setRecentNotifications([]); // Limpa em caso de erro\r\n             // Tratar erro 401 (opcional aqui, já tratado no context)\r\n        } finally {\r\n            setIsLoadingDropdown(false);\r\n        }\r\n    }, [unreadCount, isLoadingDropdown]); // Adicionado isLoadingDropdown como dependência\r\n\r\n    // Função para abrir/fechar o dropdown\r\n    const toggleDropdown = () => {\r\n        const nextState = !isDropdownOpen;\r\n        setIsDropdownOpen(nextState);\r\n        // Busca notificações ao abrir (se houver não lidas)\r\n        if (nextState && unreadCount > 0) {\r\n            fetchRecentNotifications();\r\n        }\r\n    };\r\n\r\n    // Função para marcar todas como lidas\r\n    const handleMarkAllRead = async () => {\r\n        \r\n        // Verifica se há algo para marcar\r\n        if (unreadCount === 0) {\r\n            setIsDropdownOpen(false); // Fecha o dropdown se já estiver vazio\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const token = localStorage.getItem('access_token');\r\n            if (!token) throw new Error(\"Token não encontrado\");\r\n\r\n            // Chama o novo endpoint do backend usando POST\r\n            await axios.post(\r\n                `${API_BASE_URL}/api/notificacoes/marcar-todas-como-lidas/`, \r\n                {}, // Corpo da requisição vazio, pois a ação não precisa de dados extras\r\n                { headers: { 'Authorization': `Bearer ${token}` } }\r\n            ); \r\n            \r\n            // Após sucesso:\r\n            fetchUnreadCount(); // Pede ao Contexto para atualizar a contagem global (deve ir para 0)\r\n            setRecentNotifications([]); // Limpa a lista local no dropdown\r\n            setIsDropdownOpen(false); // Fecha o dropdown\r\n\r\n        } catch (error) {\r\n            console.error(\"Erro ao marcar todas como lidas:\", error.response?.data || error.message);\r\n            alert(\"Erro ao marcar notificações como lidas. Verifique o console.\");\r\n            // Não fecha o dropdown em caso de erro para o usuário ver\r\n        }\r\n    };\r\n\r\n     // Efeito para fechar dropdown ao clicar fora\r\n     useEffect(() => {\r\n         const handleClickOutside = (event) => {\r\n             // Verifica se o clique foi fora do elemento referenciado pelo dropdownRef\r\n             if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\r\n                 setIsDropdownOpen(false);\r\n             }\r\n         };\r\n         if (isDropdownOpen) {\r\n             document.addEventListener('mousedown', handleClickOutside);\r\n         } else {\r\n             document.removeEventListener('mousedown', handleClickOutside);\r\n         }\r\n         return () => { // Limpeza ao desmontar\r\n             document.removeEventListener('mousedown', handleClickOutside);\r\n         };\r\n     }, [isDropdownOpen]);\r\n\r\n\r\n    // Função para formatar tempo relativo\r\n    const formatTempoAtras = (dateString) => {\r\n         try {\r\n             const date = new Date(dateString);\r\n             return formatDistanceToNow(date, { addSuffix: true, locale: ptBR });\r\n         } catch (e) {\r\n             console.error(\"Erro formatando data:\", dateString, e);\r\n             return dateString;\r\n         }\r\n    };\r\n\r\n    // Função para pegar o título da página (ajustada para rotas dinâmicas)\r\n    const getPageTitle = () => {\r\n        let title = 'DrGus'; // Título padrão\r\n        // Verifica rotas exatas primeiro\r\n        if (pageTitles[location.pathname]) {\r\n            title = pageTitles[location.pathname];\r\n        } else {\r\n            // Verifica rotas com parâmetros (ex: /patients/:id)\r\n            for (const path in pageTitles) {\r\n                if (path.includes(':')) {\r\n                    // Cria uma regex a partir do padrão da rota\r\n                    // Ex: /patients/:id vira /patients/[^/]+\r\n                    const regexPath = new RegExp(`^${path.replace(/:\\w+/g, '[^/]+')}$`);\r\n                    if (regexPath.test(location.pathname)) {\r\n                        title = pageTitles[path];\r\n                        break; // Encontrou, pode parar\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return title;\r\n    };\r\n    const currentPageTitle = getPageTitle();\r\n\r\n    return (\r\n        <header className=\"app-header-common\">\r\n            <div className=\"page-title\">{currentPageTitle}</div>\r\n\r\n            {/* Ícone de Notificação agora como botão com dropdown */}\r\n            <div className=\"notification-icon-wrapper\" ref={dropdownRef}>\r\n                <button type=\"button\" className=\"notification-icon-button\" onClick={toggleDropdown} aria-label=\"Abrir notificações\" aria-haspopup=\"true\" aria-expanded={isDropdownOpen}>\r\n                    <i className='bx bxs-bell'></i> {/* Ícone do sino */}\r\n                     {/* Badge (mostra se não estiver carregando e houver > 0) */}\r\n                     {!isLoadingCount && unreadCount > 0 && (\r\n                         <span className=\"notification-badge\">{unreadCount > 9 ? '9+' : unreadCount}</span>\r\n                     )}\r\n                </button>\r\n\r\n                {/* O Dropdown */}\r\n                {isDropdownOpen && (\r\n                    <div className=\"notification-dropdown\">\r\n                        <div className=\"dropdown-header\">\r\n                            <span>Notificações Recentes</span>\r\n                            {/* Mostra botão \"Marcar todas\" apenas se houver notificações listadas */}\r\n                            {!isLoadingDropdown && recentNotifications.length > 0 && (\r\n                                <button onClick={handleMarkAllRead} className=\"mark-all-read-button\">\r\n                                    Marcar todas como lidas\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                        <ul className=\"notification-list\">\r\n                            {isLoadingDropdown ? (\r\n                                <li className=\"notification-item loading\">Carregando...</li>\r\n                            ) : recentNotifications.length > 0 ? (\r\n                                recentNotifications.map(notif => (\r\n                                    <li key={notif.id_notificacao} className=\"notification-item\">\r\n                                            <div className=\"notification-link\"> {/* Div para manter estilo */}\r\n                                                <p className=\"notification-message\">{notif.mensagem}</p>\r\n                                                <span className=\"notification-time\">{formatTempoAtras(notif.data_criacao)}</span>\r\n                                            </div>\r\n                                    </li>\r\n                                ))\r\n                            ) : (\r\n                                <li className=\"notification-item empty\">Nenhuma notificação nova.</li>\r\n                            )}\r\n                        </ul>\r\n                         <div className=\"dropdown-footer\">\r\n                             {/* Link para a página principal de notificações */}\r\n                             <Link to=\"/notificacoes\" onClick={() => setIsDropdownOpen(false)}>\r\n                                 Ver todas as notificações\r\n                             </Link>\r\n                         </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default Header;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}