{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\milen\\\\Desktop\\\\4\\xBA ano\\\\projeto\\\\ProjetoDrGus\\\\frontend\\\\src\\\\paginas\\\\Pagamentos.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport './Pagamentos.css';\nimport { useNavigate } from 'react-router-dom';\nimport { format } from 'date-fns';\nimport Modal from '../componentes/Modal';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faQuestionCircle } from '@fortawesome/free-solid-svg-icons';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL;\nconst mockFormasPagamento = ['Cartão de Crédito', 'Débito', 'Pix', 'Dinheiro'];\nfunction Pagamentos() {\n  _s();\n  //Estados\n  const [pacientes, setPacientes] = useState([]);\n  const [selectedPacienteId, setSelectedPacienteId] = useState('');\n  const [loadingPacientes, setLoadingPacientes] = useState(true);\n  const [loadingParcelas, setLoadingParcelas] = useState(true);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n  const [abaAtiva, setAbaAtiva] = useState('registrar');\n  const [modoDeExibicao, setModoDeExibicao] = useState('lista');\n  const [isAjudaOpen, setIsAjudaOpen] = useState(false);\n  const [parcelasPendentes, setParcelasPendentes] = useState([]);\n  const [parcelasPagas, setParcelasPagas] = useState([]);\n  const [selectedParcela, setSelectedParcela] = useState(null);\n  const [recebimentoData, setRecebimentoData] = useState({\n    data_recebimento: '',\n    valor_recebido: '',\n    tipo: ''\n  });\n\n  //Funções de Busca\n  const fetchPacientes = useCallback(async () => {\n    setLoadingPacientes(true);\n    try {\n      const token = localStorage.getItem('access_token');\n      if (!token) throw new Error('Token de autenticação não encontrado.');\n      const response = await axios.get(`${API_BASE_URL}/api/pacientes/`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setPacientes(response.data.results || response.data || []);\n    } catch (err) {\n      console.error('Erro ao buscar pacientes:', err);\n      setError('Falha ao carregar pacientes.');\n      if (err.response && err.response.status === 401) {\n        alert('Sessão expirada. Faça login novamente.');\n        navigate('/login');\n      }\n    } finally {\n      setLoadingPacientes(false);\n    }\n  }, [navigate]);\n  const fetchParcelas = useCallback(async pacienteId => {\n    setLoadingParcelas(true);\n    setError(null);\n    setSelectedParcela(null);\n    setModoDeExibicao('lista');\n    let url = `${API_BASE_URL}/api/parcelas/`;\n    let params = {};\n    if (pacienteId) {\n      // Quando há paciente selecionado, busca todas, mas prioriza pendentes/atrasadas na aba principal\n      params = {\n        paciente_id: pacienteId,\n        status: ['Pendente', 'Atrasado', 'Pago']\n      };\n    } else {\n      // Quando nenhum paciente, mostra apenas pendentes/atrasadas\n      params = {\n        status: ['Pendente', 'Atrasado']\n      };\n      setParcelasPagas([]);\n      setAbaAtiva('registrar');\n    }\n    try {\n      const token = localStorage.getItem('access_token');\n      if (!token) throw new Error('Token não encontrado.');\n      const response = await axios.get(url, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        params: params,\n        paramsSerializer: {\n          serialize: params => {\n            const query = new URLSearchParams();\n            Object.keys(params).forEach(key => {\n              const value = params[key];\n              if (Array.isArray(value)) {\n                value.forEach(v => query.append(key, v));\n              } else {\n                query.append(key, value);\n              }\n            });\n            return query.toString();\n          }\n        }\n      });\n      const todasParcelas = response.data.results || response.data || [];\n      if (pacienteId) {\n        // Se filtramos por paciente, separamos pagos e pendentes\n        const pendentes = todasParcelas.filter(p => p.status === 'Pendente' || p.status === 'Atrasado');\n        const pagas = todasParcelas.filter(p => p.status === 'Pago');\n        setParcelasPendentes(pendentes);\n        setParcelasPagas(pagas);\n      } else {\n        // Se não filtramos (visão geral), todos são pendentes\n        setParcelasPendentes(todasParcelas);\n        setParcelasPagas([]); // Garante que o histórico está vazio\n      }\n    } catch (err) {\n      console.error('Erro ao buscar parcelas:', err);\n      setError('Falha ao carregar parcelas.');\n      setParcelasPendentes([]);\n      setParcelasPagas([]);\n      if (err.response && err.response.status === 401) {\n        alert('Sessão expirada. Faça login novamente.');\n        navigate('/login');\n      }\n    } finally {\n      setLoadingParcelas(false);\n    }\n  }, [navigate]);\n  useEffect(() => {\n    fetchPacientes();\n    fetchParcelas(null);\n  }, [fetchPacientes, fetchParcelas]);\n  const handlePacienteChange = e => {\n    const pacienteId = e.target.value;\n    setSelectedPacienteId(pacienteId);\n    fetchParcelas(pacienteId || null);\n  };\n  const handleParcelaSelect = parcela => {\n    setSelectedParcela(parcela);\n    setRecebimentoData({\n      valor_recebido: parseFloat(parcela.valor_parcela).toFixed(2),\n      data_recebimento: format(new Date(), 'yyyy-MM-dd'),\n      tipo: ''\n    });\n    setModoDeExibicao('formulario');\n  };\n  const handleRecebimentoInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setRecebimentoData(prevState => ({\n      ...prevState,\n      [name]: value\n    }));\n  };\n  const handleSaveRecebimento = async e => {\n    e.preventDefault();\n    if (!selectedParcela) {\n      alert('Selecione uma parcela...');\n      return;\n    }\n    const token = localStorage.getItem('access_token');\n    const userId = localStorage.getItem('user_id');\n    if (!token || !userId) {\n      alert('Erro de autenticação...');\n      navigate('/');\n      return;\n    }\n    if (!recebimentoData.data_recebimento || !recebimentoData.valor_recebido || !recebimentoData.tipo) {\n      alert('Preencha todos os campos...');\n      return;\n    }\n    try {\n      const dataParaBackend = {\n        parcela: selectedParcela.id_parcela,\n        usuario: parseInt(userId),\n        data_recebimento: recebimentoData.data_recebimento,\n        valor_recebido: parseFloat(recebimentoData.valor_recebido),\n        tipo: recebimentoData.tipo\n      };\n      await axios.post(`${API_BASE_URL}/api/recebimentos/`, dataParaBackend, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      alert('Recebimento registrado com sucesso!');\n      if (selectedPacienteId) {\n        fetchParcelas(selectedPacienteId);\n      } else {\n        fetchParcelas(null);\n      }\n      if (selectedPacienteId) {\n        setAbaAtiva('historico');\n      } else {\n        setAbaAtiva('registrar');\n      }\n      setSelectedParcela(null);\n      setRecebimentoData({\n        data_recebimento: '',\n        valor_recebido: '',\n        tipo: ''\n      });\n      setModoDeExibicao('lista');\n    } catch (err) {\n      let errorMessage = \"Erro desconhecido.\";\n      if (err.response && err.response.data) {\n        const responseData = err.response.data;\n        console.error('Erro backend:', responseData);\n        if (responseData.non_field_errors) {\n          errorMessage = responseData.non_field_errors.join(' ');\n        } else if (responseData.detail) {\n          errorMessage = responseData.detail;\n        } else {\n          errorMessage = JSON.stringify(responseData);\n        }\n      } else {\n        errorMessage = err.message;\n      }\n      alert(`Erro ao registrar recebimento: ${errorMessage}`);\n      setError(errorMessage);\n    }\n  };\n  const handleCancelarSelecao = () => {\n    setModoDeExibicao('lista');\n    setSelectedParcela(null);\n    setRecebimentoData({\n      data_recebimento: '',\n      valor_recebido: '',\n      tipo: ''\n    });\n    setError(null);\n  };\n  const formatDateBR = dateString => {\n    // ... (código mantido) ...\n    if (!dateString) return '-';\n    try {\n      return format(new Date(dateString + 'T00:00:00'), 'dd/MM/yyyy');\n    } catch (e) {\n      console.error(\"Erro formatando data:\", dateString, e);\n      return dateString;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pagamentos-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          marginTop: 0,\n          marginBottom: '1.5rem'\n        },\n        children: \"Controle de Pagamentos\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error-message\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"paciente\",\n          title: \"Filtre por um paciente espec\\xEDfico ou veja as pend\\xEAncias de todos.\",\n          children: \"Filtrar por Paciente:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"paciente\",\n          name: \"paciente\",\n          value: selectedPacienteId,\n          onChange: handlePacienteChange,\n          className: \"select-field\",\n          title: \"Filtre por um paciente espec\\xEDfico ou veja as pend\\xEAncias de todos.\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Todos os Pacientes (Vis\\xE3o Geral)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 13\n          }, this), loadingPacientes ? /*#__PURE__*/_jsxDEV(\"option\", {\n            disabled: true,\n            children: \"Carregando pacientes...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 15\n          }, this) : pacientes.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: p.id_paciente,\n            children: p.nome\n          }, p.id_paciente, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 35\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pagamentos-tabs-container\",\n        style: {\n          marginTop: '1.5rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${abaAtiva === 'registrar' ? 'active' : ''}`,\n          onClick: () => setAbaAtiva('registrar'),\n          title: \"Clique aqui para ver as parcelas pendentes ou atrasadas.\",\n          children: selectedPacienteId ? 'Pendentes do Paciente' : 'Visão Geral (Pendentes)'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), selectedPacienteId && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${abaAtiva === 'historico' ? 'active' : ''}`,\n          onClick: () => setAbaAtiva('historico'),\n          title: \"Clique aqui para ver todas as parcelas que j\\xE1 foram pagas.\",\n          children: \"Hist\\xF3rico (Pagos)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this), loadingParcelas && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-message\",\n        children: \"Buscando parcelas...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: abaAtiva === 'registrar' ? 'block' : 'none'\n        },\n        children: [modoDeExibicao === 'lista' && !loadingParcelas && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Parcelas Pendentes / Atrasadas\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"parcelas-tabela-wrapper\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"parcelas-tabela\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Selecionar\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 285,\n                    columnNumber: 23\n                  }, this), !selectedPacienteId && /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Paciente\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 286,\n                    columnNumber: 48\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"ID Parcela\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 287,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Vencimento\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 288,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Valor (R$)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 289,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Status\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 290,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: parcelasPendentes.length > 0 ? parcelasPendentes.map(parcela => {\n                  var _parcela$orcamento, _parcela$orcamento$pa;\n                  return /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                      children: /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => handleParcelaSelect(parcela),\n                        className: \"button-select-parcela\",\n                        title: \"Clique para abrir o formul\\xE1rio de registro de pagamento para esta parcela.\",\n                        children: \"Pagar\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 298,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 297,\n                      columnNumber: 27\n                    }, this), !selectedPacienteId && /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: ((_parcela$orcamento = parcela.orcamento) === null || _parcela$orcamento === void 0 ? void 0 : (_parcela$orcamento$pa = _parcela$orcamento.paciente) === null || _parcela$orcamento$pa === void 0 ? void 0 : _parcela$orcamento$pa.nome) || 'Paciente não encontrado'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 307,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: parcela.id_parcela\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 309,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: formatDateBR(parcela.data_vencimento)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 310,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: parseFloat(parcela.valor_parcela).toFixed(2)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 311,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: parcela.status\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 312,\n                      columnNumber: 27\n                    }, this)]\n                  }, parcela.id_parcela, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 296,\n                    columnNumber: 25\n                  }, this);\n                }) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: /*#__PURE__*/_jsxDEV(\"td\", {\n                    colSpan: !selectedPacienteId ? 7 : 6,\n                    style: {\n                      textAlign: 'center'\n                    },\n                    children: \"Nenhuma parcela pendente encontrada.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 317,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 316,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 13\n        }, this), modoDeExibicao === 'formulario' && selectedParcela && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Registrar Pagamento da Parcela\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              marginTop: '-1rem',\n              marginBottom: '1.5rem',\n              fontSize: '0.9rem',\n              color: '#555'\n            },\n            children: [\"Vencimento: \", formatDateBR(selectedParcela.data_vencimento), ' - ', \"Valor: R$ \", parseFloat(selectedParcela.valor_parcela).toFixed(2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Valor da Parcela:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: `R$ ${parseFloat(selectedParcela.valor_parcela).toFixed(2)}`,\n                className: \"input-field-readonly\",\n                readOnly: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Data de Vencimento:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: formatDateBR(selectedParcela.data_vencimento),\n                className: \"input-field-readonly\",\n                readOnly: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleSaveRecebimento,\n            className: \"pagamentos-form-simple\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"data_recebimento\",\n                  title: \"A data em que o pagamento foi efetivamente recebido.\",\n                  children: \"Data do Pagamento: *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"date\",\n                  id: \"data_recebimento\",\n                  name: \"data_recebimento\",\n                  value: recebimentoData.data_recebimento,\n                  onChange: handleRecebimentoInputChange,\n                  required: true,\n                  className: \"input-field\",\n                  title: \"A data em que o pagamento foi efetivamente recebido.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"valor_recebido\",\n                  title: \"Insira o valor exato recebido. Pode ser um valor parcial ou o total da parcela.\",\n                  children: \"Valor Recebido (R$): *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  id: \"valor_recebido\",\n                  name: \"valor_recebido\",\n                  value: recebimentoData.valor_recebido,\n                  onChange: handleRecebimentoInputChange,\n                  step: \"0.01\",\n                  required: true,\n                  className: \"input-field\",\n                  title: \"Insira o valor exato recebido. Pode ser um valor parcial ou o total da parcela.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 375,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 368,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"tipo\",\n                  title: \"Selecione o m\\xE9todo que o paciente usou para pagar (Pix, Dinheiro, Cart\\xE3o, etc.).\",\n                  children: \"Forma de Pagamento: *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 390,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  id: \"tipo\",\n                  name: \"tipo\",\n                  value: recebimentoData.tipo,\n                  onChange: handleRecebimentoInputChange,\n                  required: true,\n                  className: \"select-field\",\n                  title: \"Selecione o m\\xE9todo que o paciente usou para pagar (Pix, Dinheiro, Cart\\xE3o, etc.).\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Selecione\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 405,\n                    columnNumber: 23\n                  }, this), mockFormasPagamento.map((forma, index) => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: forma,\n                    children: forma\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 406,\n                    columnNumber: 67\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 396,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 389,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                style: {\n                  flex: 1\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 409,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-actions-pagamento\",\n              style: {\n                justifyContent: 'space-between'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"button-secondary\",\n                onClick: handleCancelarSelecao,\n                title: \"Clique para fechar este formul\\xE1rio e voltar para a lista de parcelas.\",\n                children: \"Cancelar Sele\\xE7\\xE3o\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 412,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"button-primary\",\n                title: \"Clique para salvar este pagamento e marcar a parcela como 'Paga'.\",\n                children: \"Confirmar Recebimento\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 420,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 9\n      }, this), selectedPacienteId && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: abaAtiva === 'historico' ? 'block' : 'none'\n        },\n        children: !loadingParcelas && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Hist\\xF3rico de Parcelas Pagas\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"parcelas-tabela-wrapper\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"parcelas-tabela\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"ID Parcela\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 443,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Vencimento\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 444,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Valor (R$)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 445,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Status\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 446,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Data Pagamento\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 447,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Forma Pagamento\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 448,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: parcelasPagas.length > 0 ? parcelasPagas.map(parcela => {\n                  const recebimento = parcela.recebimentos && parcela.recebimentos[0] ? parcela.recebimentos[0] : {};\n                  return /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                      children: parcela.id_parcela\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 459,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: formatDateBR(parcela.data_vencimento)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 460,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: parseFloat(parcela.valor_parcela).toFixed(2)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 461,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: parcela.status\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 462,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: formatDateBR(recebimento.data_recebimento)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 463,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: recebimento.tipo || '-'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 464,\n                      columnNumber: 31\n                    }, this)]\n                  }, parcela.id_parcela, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 458,\n                    columnNumber: 29\n                  }, this);\n                }) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: /*#__PURE__*/_jsxDEV(\"td\", {\n                    colSpan: \"6\",\n                    style: {\n                      textAlign: 'center'\n                    },\n                    children: \"Nenhum pagamento registrado para este paciente.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 470,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 469,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 451,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"floating-help-button\",\n      onClick: () => setIsAjudaOpen(true),\n      title: \"Ajuda sobre esta p\\xE1gina\",\n      children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: faQuestionCircle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isAjudaOpen,\n      onClose: () => setIsAjudaOpen(false),\n      titulo: \"Ajuda - Controle de Pagamentos\",\n      footer: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"modal-button modal-button-secondary\",\n        onClick: () => setIsAjudaOpen(false),\n        title: \"Fechar esta janela de ajuda.\",\n        children: \"Fechar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 11\n      }, this),\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Esta tela permite gerenciar todas as parcelas de pagamentos dos pacientes.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          paddingLeft: '20px',\n          lineHeight: '1.6'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Vis\\xE3o Geral:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 13\n          }, this), \" Por padr\\xE3o, a tela carrega todas as parcelas \\\"Pendentes\\\" e \\\"Atrasadas\\\" de todos os pacientes.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Filtrar por Paciente:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 13\n          }, this), \" Use o seletor para focar em um paciente espec\\xEDfico. Isso mostrar\\xE1 as parcelas pendentes e habilitar\\xE1 a aba \\\"Hist\\xF3rico (Pagos)\\\" apenas para ele.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Registrar Pagamento:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 13\n          }, this), \" Na aba de pend\\xEAncias, clique em \\\"Pagar\\\" para abrir o formul\\xE1rio de registro de pagamento.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 216,\n    columnNumber: 5\n  }, this);\n}\n_s(Pagamentos, \"xJy1nhMyv7YonvUa70EequDcQIY=\", false, function () {\n  return [useNavigate];\n});\n_c = Pagamentos;\nexport default Pagamentos;\nvar _c;\n$RefreshReg$(_c, \"Pagamentos\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","useNavigate","format","Modal","FontAwesomeIcon","faQuestionCircle","jsxDEV","_jsxDEV","Fragment","_Fragment","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","mockFormasPagamento","Pagamentos","_s","pacientes","setPacientes","selectedPacienteId","setSelectedPacienteId","loadingPacientes","setLoadingPacientes","loadingParcelas","setLoadingParcelas","error","setError","navigate","abaAtiva","setAbaAtiva","modoDeExibicao","setModoDeExibicao","isAjudaOpen","setIsAjudaOpen","parcelasPendentes","setParcelasPendentes","parcelasPagas","setParcelasPagas","selectedParcela","setSelectedParcela","recebimentoData","setRecebimentoData","data_recebimento","valor_recebido","tipo","fetchPacientes","token","localStorage","getItem","Error","response","get","headers","data","results","err","console","status","alert","fetchParcelas","pacienteId","url","params","paciente_id","paramsSerializer","serialize","query","URLSearchParams","Object","keys","forEach","key","value","Array","isArray","v","append","toString","todasParcelas","pendentes","filter","p","pagas","handlePacienteChange","e","target","handleParcelaSelect","parcela","parseFloat","valor_parcela","toFixed","Date","handleRecebimentoInputChange","name","prevState","handleSaveRecebimento","preventDefault","userId","dataParaBackend","id_parcela","usuario","parseInt","post","errorMessage","responseData","non_field_errors","join","detail","JSON","stringify","message","handleCancelarSelecao","formatDateBR","dateString","className","children","style","marginTop","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","title","id","onChange","disabled","map","id_paciente","nome","onClick","display","length","_parcela$orcamento","_parcela$orcamento$pa","orcamento","paciente","data_vencimento","colSpan","textAlign","fontSize","color","type","readOnly","onSubmit","required","step","forma","index","flex","justifyContent","recebimento","recebimentos","icon","isOpen","onClose","titulo","footer","paddingLeft","lineHeight","_c","$RefreshReg$"],"sources":["C:/Users/milen/Desktop/4º ano/projeto/ProjetoDrGus/frontend/src/paginas/Pagamentos.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport './Pagamentos.css';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { format } from 'date-fns';\r\nimport Modal from '../componentes/Modal';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faQuestionCircle } from '@fortawesome/free-solid-svg-icons';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL;\r\nconst mockFormasPagamento = ['Cartão de Crédito', 'Débito', 'Pix', 'Dinheiro'];\r\n\r\nfunction Pagamentos() {\r\n  //Estados\r\n  const [pacientes, setPacientes] = useState([]);\r\n  const [selectedPacienteId, setSelectedPacienteId] = useState('');\r\n  const [loadingPacientes, setLoadingPacientes] = useState(true);\r\n  const [loadingParcelas, setLoadingParcelas] = useState(true); \r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n  const [abaAtiva, setAbaAtiva] = useState('registrar'); \r\n  const [modoDeExibicao, setModoDeExibicao] = useState('lista'); \r\n  const [isAjudaOpen, setIsAjudaOpen] = useState(false); \r\n  const [parcelasPendentes, setParcelasPendentes] = useState([]);\r\n  const [parcelasPagas, setParcelasPagas] = useState([]); \r\n  const [selectedParcela, setSelectedParcela] = useState(null);\r\n  const [recebimentoData, setRecebimentoData] = useState({\r\n    data_recebimento: '',\r\n    valor_recebido: '',\r\n    tipo: '',\r\n  });\r\n\r\n  //Funções de Busca\r\n  const fetchPacientes = useCallback(async () => {\r\n    setLoadingPacientes(true);\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      if (!token) throw new Error('Token de autenticação não encontrado.');\r\n      const response = await axios.get(`${API_BASE_URL}/api/pacientes/`, {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      setPacientes(response.data.results || response.data || []);\r\n    } catch (err) {\r\n      console.error('Erro ao buscar pacientes:', err);\r\n      setError('Falha ao carregar pacientes.');\r\n      if (err.response && err.response.status === 401) {\r\n        alert('Sessão expirada. Faça login novamente.');\r\n        navigate('/login');\r\n      }\r\n    } finally {\r\n      setLoadingPacientes(false);\r\n    }\r\n  }, [navigate]);\r\n\r\n  const fetchParcelas = useCallback(async (pacienteId) => {\r\n    setLoadingParcelas(true);\r\n    setError(null);\r\n    setSelectedParcela(null);\r\n    setModoDeExibicao('lista');\r\n\r\n    let url = `${API_BASE_URL}/api/parcelas/`;\r\n    let params = {};\r\n\r\n    if (pacienteId) {\r\n      // Quando há paciente selecionado, busca todas, mas prioriza pendentes/atrasadas na aba principal\r\n      params = { paciente_id: pacienteId, status: ['Pendente', 'Atrasado', 'Pago'] };\r\n    } else {\r\n      // Quando nenhum paciente, mostra apenas pendentes/atrasadas\r\n      params = { status: ['Pendente', 'Atrasado'] };\r\n      setParcelasPagas([]);\r\n      setAbaAtiva('registrar');\r\n    }\r\n\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      if (!token) throw new Error('Token não encontrado.');\r\n\r\n      const response = await axios.get(url, {\r\n        headers: { 'Authorization': `Bearer ${token}` },\r\n        params: params,\r\n        paramsSerializer: {\r\n          serialize: (params) => {\r\n            const query = new URLSearchParams();\r\n            Object.keys(params).forEach((key) => {\r\n              const value = params[key];\r\n              if (Array.isArray(value)) {\r\n                value.forEach(v => query.append(key, v));\r\n              } else {\r\n                query.append(key, value);\r\n              }\r\n            });\r\n            return query.toString();\r\n          }\r\n        }\r\n      });\r\n\r\n      const todasParcelas = response.data.results || response.data || [];\r\n\r\n      if (pacienteId) {\r\n        // Se filtramos por paciente, separamos pagos e pendentes\r\n        const pendentes = todasParcelas.filter(p => p.status === 'Pendente' || p.status === 'Atrasado');\r\n        const pagas = todasParcelas.filter(p => p.status === 'Pago');\r\n        setParcelasPendentes(pendentes);\r\n        setParcelasPagas(pagas);\r\n      } else {\r\n        // Se não filtramos (visão geral), todos são pendentes\r\n        setParcelasPendentes(todasParcelas);\r\n        setParcelasPagas([]); // Garante que o histórico está vazio\r\n      }\r\n\r\n    } catch (err) {\r\n      console.error('Erro ao buscar parcelas:', err);\r\n      setError('Falha ao carregar parcelas.');\r\n      setParcelasPendentes([]);\r\n      setParcelasPagas([]);\r\n      if (err.response && err.response.status === 401) {\r\n        alert('Sessão expirada. Faça login novamente.');\r\n        navigate('/login');\r\n      }\r\n    } finally {\r\n      setLoadingParcelas(false);\r\n    }\r\n  }, [navigate]);\r\n  \r\n  useEffect(() => {\r\n    fetchPacientes();\r\n    fetchParcelas(null); \r\n  }, [fetchPacientes, fetchParcelas]); \r\n\r\n  const handlePacienteChange = (e) => {\r\n    const pacienteId = e.target.value;\r\n    setSelectedPacienteId(pacienteId);\r\n    fetchParcelas(pacienteId || null);\r\n  };\r\n\r\n  const handleParcelaSelect = (parcela) => {\r\n    setSelectedParcela(parcela);\r\n    setRecebimentoData({\r\n      valor_recebido: parseFloat(parcela.valor_parcela).toFixed(2),\r\n      data_recebimento: format(new Date(), 'yyyy-MM-dd'),\r\n      tipo: '',\r\n    });\r\n    setModoDeExibicao('formulario');\r\n  };\r\n  \r\n  const handleRecebimentoInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setRecebimentoData(prevState => ({ ...prevState, [name]: value }));\r\n  };\r\n\r\n  const handleSaveRecebimento = async (e) => {\r\n    e.preventDefault();\r\n    if (!selectedParcela) { alert('Selecione uma parcela...'); return; }\r\n    const token = localStorage.getItem('access_token');\r\n    const userId = localStorage.getItem('user_id');\r\n    if (!token || !userId) { alert('Erro de autenticação...'); navigate('/'); return; }\r\n    if (!recebimentoData.data_recebimento || !recebimentoData.valor_recebido || !recebimentoData.tipo) { alert('Preencha todos os campos...'); return; }\r\n    try {\r\n      const dataParaBackend = {\r\n        parcela: selectedParcela.id_parcela,\r\n        usuario: parseInt(userId),\r\n        data_recebimento: recebimentoData.data_recebimento,\r\n        valor_recebido: parseFloat(recebimentoData.valor_recebido),\r\n        tipo: recebimentoData.tipo,\r\n      };\r\n      await axios.post(`${API_BASE_URL}/api/recebimentos/`, dataParaBackend, {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n      alert('Recebimento registrado com sucesso!');\r\n\r\n      if (selectedPacienteId) {\r\n        fetchParcelas(selectedPacienteId);\r\n      } else {\r\n        fetchParcelas(null);\r\n      }\r\n\r\n      if (selectedPacienteId) {\r\n        setAbaAtiva('historico');\r\n      } else {\r\n        setAbaAtiva('registrar');\r\n      }\r\n\r\n      setSelectedParcela(null);\r\n      setRecebimentoData({ data_recebimento: '', valor_recebido: '', tipo: '' });\r\n      setModoDeExibicao('lista'); \r\n    } catch (err) {\r\n      let errorMessage = \"Erro desconhecido.\";\r\n      if (err.response && err.response.data) {\r\n          const responseData = err.response.data;\r\n          console.error('Erro backend:', responseData);\r\n          if (responseData.non_field_errors) { errorMessage = responseData.non_field_errors.join(' ');\r\n          } else if (responseData.detail) { errorMessage = responseData.detail;\r\n          } else { errorMessage = JSON.stringify(responseData); }\r\n      } else { errorMessage = err.message; }\r\n      alert(`Erro ao registrar recebimento: ${errorMessage}`);\r\n      setError(errorMessage);\r\n    }\r\n  };\r\n\r\n  const handleCancelarSelecao = () => {\r\n    setModoDeExibicao('lista');\r\n    setSelectedParcela(null);\r\n    setRecebimentoData({ data_recebimento: '', valor_recebido: '', tipo: '' });\r\n    setError(null);\r\n  };\r\n\r\n  const formatDateBR = (dateString) => {\r\n    // ... (código mantido) ...\r\n    if (!dateString) return '-';\r\n    try {\r\n      return format(new Date(dateString + 'T00:00:00'), 'dd/MM/yyyy');\r\n    } catch (e) { console.error(\"Erro formatando data:\", dateString, e); return dateString; }\r\n  };\r\n\r\n  return (\r\n    <div className=\"pagamentos-container\">\r\n      {/* 1. Seleção do Paciente / Filtro */}\r\n      <div className=\"card-section\">\r\n\r\n        {/* --- CORREÇÃO: Título com espaçamento (sem botão) --- */}\r\n        <h2 style={{marginTop: 0, marginBottom: '1.5rem'}}>Controle de Pagamentos</h2>\r\n\r\n        {error && <p className=\"error-message\">{error}</p>}\r\n\r\n        {/* --- CORREÇÃO: Espaçamento (form-group já tem margin-bottom) --- */}\r\n        <div className=\"form-group\">\r\n          <label \r\n            htmlFor=\"paciente\"\r\n            title=\"Filtre por um paciente específico ou veja as pendências de todos.\"\r\n          >\r\n            Filtrar por Paciente:\r\n          </label>\r\n          <select \r\n            id=\"paciente\" \r\n            name=\"paciente\" \r\n            value={selectedPacienteId} \r\n            onChange={handlePacienteChange} \r\n            className=\"select-field\"\r\n            title=\"Filtre por um paciente específico ou veja as pendências de todos.\"\r\n          >\r\n            <option value=\"\">Todos os Pacientes (Visão Geral)</option>\r\n            {loadingPacientes ? (\r\n              <option disabled>Carregando pacientes...</option>\r\n            ) : (\r\n              pacientes.map(p => (<option key={p.id_paciente} value={p.id_paciente}>{p.nome}</option>))\r\n            )}\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 2. Container das Abas */}\r\n      <>\r\n        {/* --- CORREÇÃO: Adicionado espaçamento (style) --- */}\r\n        <div className=\"pagamentos-tabs-container\" style={{marginTop: '1.5rem'}}>\r\n          <button \r\n            className={`tab-button ${abaAtiva === 'registrar' ? 'active' : ''}`}\r\n            onClick={() => setAbaAtiva('registrar')}\r\n            title=\"Clique aqui para ver as parcelas pendentes ou atrasadas.\"\r\n          >\r\n            {selectedPacienteId ? 'Pendentes do Paciente' : 'Visão Geral (Pendentes)'}\r\n          </button>\r\n          \r\n          {selectedPacienteId && (\r\n            <button \r\n              className={`tab-button ${abaAtiva === 'historico' ? 'active' : ''}`}\r\n              onClick={() => setAbaAtiva('historico')}\r\n              title=\"Clique aqui para ver todas as parcelas que já foram pagas.\"\r\n            >\r\n              Histórico (Pagos)\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {loadingParcelas && <div className=\"loading-message\">Buscando parcelas...</div>}\r\n\r\n        {/* Aba 1: Registrar (Pendentes) */}\r\n        <div style={{ display: abaAtiva === 'registrar' ? 'block' : 'none' }}>\r\n          {modoDeExibicao === 'lista' && !loadingParcelas && (\r\n            <div className=\"card-section\">\r\n              <h3>Parcelas Pendentes / Atrasadas</h3>\r\n              <div className=\"parcelas-tabela-wrapper\">\r\n                <table className=\"parcelas-tabela\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>Selecionar</th>\r\n                      {!selectedPacienteId && (<th>Paciente</th>)}\r\n                      <th>ID Parcela</th>\r\n                      <th>Vencimento</th>\r\n                      <th>Valor (R$)</th>\r\n                      <th>Status</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {parcelasPendentes.length > 0 ? (\r\n                      parcelasPendentes.map(parcela => (\r\n                        <tr key={parcela.id_parcela}>\r\n                          <td>\r\n                            <button \r\n                              onClick={() => handleParcelaSelect(parcela)} \r\n                              className=\"button-select-parcela\"\r\n                              title=\"Clique para abrir o formulário de registro de pagamento para esta parcela.\"\r\n                            >\r\n                              Pagar\r\n                            </button>\r\n                          </td>\r\n                          {!selectedPacienteId && (\r\n                            <td>{parcela.orcamento?.paciente?.nome || 'Paciente não encontrado'}</td>\r\n                          )}\r\n                          <td>{parcela.id_parcela}</td>\r\n                          <td>{formatDateBR(parcela.data_vencimento)}</td>\r\n                          <td>{parseFloat(parcela.valor_parcela).toFixed(2)}</td>\r\n                          <td>{parcela.status}</td>\r\n                        </tr>\r\n                      ))\r\n                    ) : (\r\n                      <tr>\r\n                        <td colSpan={!selectedPacienteId ? 7 : 6} style={{ textAlign: 'center' }}>\r\n                          Nenhuma parcela pendente encontrada.\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Formulário de Pagamento */}\r\n          {modoDeExibicao === 'formulario' && selectedParcela && (\r\n            <div className=\"card-section\">\r\n              <h3>Registrar Pagamento da Parcela</h3>\r\n              <p style={{marginTop: '-1rem', marginBottom: '1.5rem', fontSize: '0.9rem', color: '#555'}}>\r\n                   Vencimento: {formatDateBR(selectedParcela.data_vencimento)} \r\n                   {' - '}\r\n                   Valor: R$ {parseFloat(selectedParcela.valor_parcela).toFixed(2)}\r\n                </p>\r\n\r\n              <div className=\"form-row\">\r\n                <div className=\"form-group\">\r\n                  <label>Valor da Parcela:</label>\r\n                  <input type=\"text\" value={`R$ ${parseFloat(selectedParcela.valor_parcela).toFixed(2)}`} className=\"input-field-readonly\" readOnly />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                  <label>Data de Vencimento:</label>\r\n                  <input type=\"text\" value={formatDateBR(selectedParcela.data_vencimento)} className=\"input-field-readonly\" readOnly />\r\n                </div>\r\n              </div>\r\n              <form onSubmit={handleSaveRecebimento} className=\"pagamentos-form-simple\">\r\n                <div className=\"form-row\">\r\n                  <div className=\"form-group\">\r\n                    <label \r\n                      htmlFor=\"data_recebimento\"\r\n                      title=\"A data em que o pagamento foi efetivamente recebido.\"\r\n                    >\r\n                      Data do Pagamento: *\r\n                    </label>\r\n                    <input \r\n                      type=\"date\" \r\n                      id=\"data_recebimento\" \r\n                      name=\"data_recebimento\" \r\n                      value={recebimentoData.data_recebimento} \r\n                      onChange={handleRecebimentoInputChange} \r\n                      required \r\n                      className=\"input-field\"\r\n                      title=\"A data em que o pagamento foi efetivamente recebido.\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label \r\n                      htmlFor=\"valor_recebido\"\r\n                      title=\"Insira o valor exato recebido. Pode ser um valor parcial ou o total da parcela.\"\r\n                    >\r\n                      Valor Recebido (R$): *\r\n                    </label>\r\n                    <input \r\n                      type=\"number\" \r\n                      id=\"valor_recebido\" \r\n                      name=\"valor_recebido\" \r\n                      value={recebimentoData.valor_recebido} \r\n                      onChange={handleRecebimentoInputChange} \r\n                      step=\"0.01\" \r\n                      required \r\n                      className=\"input-field\"\r\n                      title=\"Insira o valor exato recebido. Pode ser um valor parcial ou o total da parcela.\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"form-row\">\r\n                  <div className=\"form-group\">\r\n                    <label \r\n                      htmlFor=\"tipo\"\r\n                      title=\"Selecione o método que o paciente usou para pagar (Pix, Dinheiro, Cartão, etc.).\"\r\n                    >\r\n                      Forma de Pagamento: *\r\n                    </label>\r\n                    <select \r\n                      id=\"tipo\" \r\n                      name=\"tipo\" \r\n                      value={recebimentoData.tipo} \r\n                      onChange={handleRecebimentoInputChange} \r\n                      required \r\n                      className=\"select-field\"\r\n                      title=\"Selecione o método que o paciente usou para pagar (Pix, Dinheiro, Cartão, etc.).\"\r\n                    >\r\n                      <option value=\"\">Selecione</option>\r\n                      {mockFormasPagamento.map((forma, index) => (<option key={index} value={forma}>{forma}</option>))}\r\n                    </select>\r\n                  </div>\r\n                  <div className=\"form-group\" style={{ flex: 1 }}></div>\r\n                </div>\r\n                <div className=\"form-actions-pagamento\" style={{ justifyContent: 'space-between' }}>\r\n                  <button \r\n                    type=\"button\" \r\n                    className=\"button-secondary\" \r\n                    onClick={handleCancelarSelecao}\r\n                    title=\"Clique para fechar este formulário e voltar para a lista de parcelas.\"\r\n                  >\r\n                    Cancelar Seleção\r\n                  </button>\r\n                  <button \r\n                    type=\"submit\" \r\n                    className=\"button-primary\"\r\n                    title=\"Clique para salvar este pagamento e marcar a parcela como 'Paga'.\"\r\n                  >\r\n                    Confirmar Recebimento\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Aba 2: Histórico (Pagos) */}\r\n        {selectedPacienteId && (\r\n          <div style={{ display: abaAtiva === 'historico' ? 'block' : 'none' }}>\r\n            {!loadingParcelas && (\r\n              <div className=\"card-section\">\r\n                <h3>Histórico de Parcelas Pagas</h3>\r\n                <div className=\"parcelas-tabela-wrapper\">\r\n                  <table className=\"parcelas-tabela\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>ID Parcela</th>\r\n                        <th>Vencimento</th>\r\n                        <th>Valor (R$)</th>\r\n                        <th>Status</th>\r\n                        <th>Data Pagamento</th>\r\n                        <th>Forma Pagamento</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {parcelasPagas.length > 0 ? (\r\n                        parcelasPagas.map(parcela => {\r\n                          const recebimento = (parcela.recebimentos && parcela.recebimentos[0])\r\n                            ? parcela.recebimentos[0]\r\n                            : {};\r\n                          return (\r\n                            <tr key={parcela.id_parcela}>\r\n                              <td>{parcela.id_parcela}</td>\r\n                              <td>{formatDateBR(parcela.data_vencimento)}</td>\r\n                              <td>{parseFloat(parcela.valor_parcela).toFixed(2)}</td>\r\n                              <td>{parcela.status}</td>\r\n                              <td>{formatDateBR(recebimento.data_recebimento)}</td>\r\n                              <td>{recebimento.tipo || '-'}</td>\r\n                            </tr>\r\n                          );\r\n                        })\r\n                      ) : (\r\n                        <tr>\r\n                          <td colSpan=\"6\" style={{ textAlign: 'center' }}>Nenhum pagamento registrado para este paciente.</td>\r\n                        </tr>\r\n                      )}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </>\r\n\r\n      {/* --- CORREÇÃO: BOTÃO FLUTUANTE + TEXTO DO MODAL ATUALIZADO --- */}\r\n      <button \r\n        className=\"floating-help-button\" \r\n        onClick={() => setIsAjudaOpen(true)}\r\n        title=\"Ajuda sobre esta página\"\r\n      >\r\n        <FontAwesomeIcon icon={faQuestionCircle} />\r\n      </button>\r\n\r\n      <Modal\r\n        isOpen={isAjudaOpen}\r\n        onClose={() => setIsAjudaOpen(false)}\r\n        titulo=\"Ajuda - Controle de Pagamentos\"\r\n        footer={\r\n          <button \r\n            className=\"modal-button modal-button-secondary\" \r\n            onClick={() => setIsAjudaOpen(false)}\r\n            title=\"Fechar esta janela de ajuda.\"\r\n          >\r\n            Fechar\r\n          </button>\r\n        }\r\n      >\r\n        <p>Esta tela permite gerenciar todas as parcelas de pagamentos dos pacientes.</p>\r\n        <ul style={{ paddingLeft: '20px', lineHeight: '1.6' }}>\r\n          <li>\r\n            <strong>Visão Geral:</strong> Por padrão, a tela carrega todas as parcelas \"Pendentes\" e \"Atrasadas\" de todos os pacientes.\r\n          </li>\r\n          <li>\r\n            <strong>Filtrar por Paciente:</strong> Use o seletor para focar em um paciente específico. Isso mostrará as parcelas pendentes e habilitará a aba \"Histórico (Pagos)\" apenas para ele.\r\n          </li>\r\n          <li>\r\n            <strong>Registrar Pagamento:</strong> Na aba de pendências, clique em \"Pagar\" para abrir o formulário de registro de pagamento.\r\n          </li>\r\n        </ul>\r\n      </Modal>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Pagamentos;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,kBAAkB;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,MAAM,QAAQ,UAAU;AACjC,OAAOC,KAAK,MAAM,sBAAsB;AACxC,SAASC,eAAe,QAAQ,gCAAgC;AAChE,SAASC,gBAAgB,QAAQ,mCAAmC;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAErE,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB;AACvD,MAAMC,mBAAmB,GAAG,CAAC,mBAAmB,EAAE,QAAQ,EAAE,KAAK,EAAE,UAAU,CAAC;AAE9E,SAASC,UAAUA,CAAA,EAAG;EAAAC,EAAA;EACpB;EACA,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACsB,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGvB,QAAQ,CAAC,EAAE,CAAC;EAChE,MAAM,CAACwB,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGzB,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAAC0B,eAAe,EAAEC,kBAAkB,CAAC,GAAG3B,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAAC4B,KAAK,EAAEC,QAAQ,CAAC,GAAG7B,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM8B,QAAQ,GAAG1B,WAAW,CAAC,CAAC;EAC9B,MAAM,CAAC2B,QAAQ,EAAEC,WAAW,CAAC,GAAGhC,QAAQ,CAAC,WAAW,CAAC;EACrD,MAAM,CAACiC,cAAc,EAAEC,iBAAiB,CAAC,GAAGlC,QAAQ,CAAC,OAAO,CAAC;EAC7D,MAAM,CAACmC,WAAW,EAAEC,cAAc,CAAC,GAAGpC,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACqC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGtC,QAAQ,CAAC,EAAE,CAAC;EAC9D,MAAM,CAACuC,aAAa,EAAEC,gBAAgB,CAAC,GAAGxC,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACyC,eAAe,EAAEC,kBAAkB,CAAC,GAAG1C,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAAC2C,eAAe,EAAEC,kBAAkB,CAAC,GAAG5C,QAAQ,CAAC;IACrD6C,gBAAgB,EAAE,EAAE;IACpBC,cAAc,EAAE,EAAE;IAClBC,IAAI,EAAE;EACR,CAAC,CAAC;;EAEF;EACA,MAAMC,cAAc,GAAG9C,WAAW,CAAC,YAAY;IAC7CuB,mBAAmB,CAAC,IAAI,CAAC;IACzB,IAAI;MACF,MAAMwB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;MAClD,IAAI,CAACF,KAAK,EAAE,MAAM,IAAIG,KAAK,CAAC,uCAAuC,CAAC;MACpE,MAAMC,QAAQ,GAAG,MAAMlD,KAAK,CAACmD,GAAG,CAAC,GAAGzC,YAAY,iBAAiB,EAAE;QACjE0C,OAAO,EAAE;UAAE,eAAe,EAAE,UAAUN,KAAK;QAAG;MAChD,CAAC,CAAC;MACF5B,YAAY,CAACgC,QAAQ,CAACG,IAAI,CAACC,OAAO,IAAIJ,QAAQ,CAACG,IAAI,IAAI,EAAE,CAAC;IAC5D,CAAC,CAAC,OAAOE,GAAG,EAAE;MACZC,OAAO,CAAC/B,KAAK,CAAC,2BAA2B,EAAE8B,GAAG,CAAC;MAC/C7B,QAAQ,CAAC,8BAA8B,CAAC;MACxC,IAAI6B,GAAG,CAACL,QAAQ,IAAIK,GAAG,CAACL,QAAQ,CAACO,MAAM,KAAK,GAAG,EAAE;QAC/CC,KAAK,CAAC,wCAAwC,CAAC;QAC/C/B,QAAQ,CAAC,QAAQ,CAAC;MACpB;IACF,CAAC,SAAS;MACRL,mBAAmB,CAAC,KAAK,CAAC;IAC5B;EACF,CAAC,EAAE,CAACK,QAAQ,CAAC,CAAC;EAEd,MAAMgC,aAAa,GAAG5D,WAAW,CAAC,MAAO6D,UAAU,IAAK;IACtDpC,kBAAkB,CAAC,IAAI,CAAC;IACxBE,QAAQ,CAAC,IAAI,CAAC;IACda,kBAAkB,CAAC,IAAI,CAAC;IACxBR,iBAAiB,CAAC,OAAO,CAAC;IAE1B,IAAI8B,GAAG,GAAG,GAAGnD,YAAY,gBAAgB;IACzC,IAAIoD,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIF,UAAU,EAAE;MACd;MACAE,MAAM,GAAG;QAAEC,WAAW,EAAEH,UAAU;QAAEH,MAAM,EAAE,CAAC,UAAU,EAAE,UAAU,EAAE,MAAM;MAAE,CAAC;IAChF,CAAC,MAAM;MACL;MACAK,MAAM,GAAG;QAAEL,MAAM,EAAE,CAAC,UAAU,EAAE,UAAU;MAAE,CAAC;MAC7CpB,gBAAgB,CAAC,EAAE,CAAC;MACpBR,WAAW,CAAC,WAAW,CAAC;IAC1B;IAEA,IAAI;MACF,MAAMiB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;MAClD,IAAI,CAACF,KAAK,EAAE,MAAM,IAAIG,KAAK,CAAC,uBAAuB,CAAC;MAEpD,MAAMC,QAAQ,GAAG,MAAMlD,KAAK,CAACmD,GAAG,CAACU,GAAG,EAAE;QACpCT,OAAO,EAAE;UAAE,eAAe,EAAE,UAAUN,KAAK;QAAG,CAAC;QAC/CgB,MAAM,EAAEA,MAAM;QACdE,gBAAgB,EAAE;UAChBC,SAAS,EAAGH,MAAM,IAAK;YACrB,MAAMI,KAAK,GAAG,IAAIC,eAAe,CAAC,CAAC;YACnCC,MAAM,CAACC,IAAI,CAACP,MAAM,CAAC,CAACQ,OAAO,CAAEC,GAAG,IAAK;cACnC,MAAMC,KAAK,GAAGV,MAAM,CAACS,GAAG,CAAC;cACzB,IAAIE,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE;gBACxBA,KAAK,CAACF,OAAO,CAACK,CAAC,IAAIT,KAAK,CAACU,MAAM,CAACL,GAAG,EAAEI,CAAC,CAAC,CAAC;cAC1C,CAAC,MAAM;gBACLT,KAAK,CAACU,MAAM,CAACL,GAAG,EAAEC,KAAK,CAAC;cAC1B;YACF,CAAC,CAAC;YACF,OAAON,KAAK,CAACW,QAAQ,CAAC,CAAC;UACzB;QACF;MACF,CAAC,CAAC;MAEF,MAAMC,aAAa,GAAG5B,QAAQ,CAACG,IAAI,CAACC,OAAO,IAAIJ,QAAQ,CAACG,IAAI,IAAI,EAAE;MAElE,IAAIO,UAAU,EAAE;QACd;QACA,MAAMmB,SAAS,GAAGD,aAAa,CAACE,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACxB,MAAM,KAAK,UAAU,IAAIwB,CAAC,CAACxB,MAAM,KAAK,UAAU,CAAC;QAC/F,MAAMyB,KAAK,GAAGJ,aAAa,CAACE,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACxB,MAAM,KAAK,MAAM,CAAC;QAC5DtB,oBAAoB,CAAC4C,SAAS,CAAC;QAC/B1C,gBAAgB,CAAC6C,KAAK,CAAC;MACzB,CAAC,MAAM;QACL;QACA/C,oBAAoB,CAAC2C,aAAa,CAAC;QACnCzC,gBAAgB,CAAC,EAAE,CAAC,CAAC,CAAC;MACxB;IAEF,CAAC,CAAC,OAAOkB,GAAG,EAAE;MACZC,OAAO,CAAC/B,KAAK,CAAC,0BAA0B,EAAE8B,GAAG,CAAC;MAC9C7B,QAAQ,CAAC,6BAA6B,CAAC;MACvCS,oBAAoB,CAAC,EAAE,CAAC;MACxBE,gBAAgB,CAAC,EAAE,CAAC;MACpB,IAAIkB,GAAG,CAACL,QAAQ,IAAIK,GAAG,CAACL,QAAQ,CAACO,MAAM,KAAK,GAAG,EAAE;QAC/CC,KAAK,CAAC,wCAAwC,CAAC;QAC/C/B,QAAQ,CAAC,QAAQ,CAAC;MACpB;IACF,CAAC,SAAS;MACRH,kBAAkB,CAAC,KAAK,CAAC;IAC3B;EACF,CAAC,EAAE,CAACG,QAAQ,CAAC,CAAC;EAEd7B,SAAS,CAAC,MAAM;IACd+C,cAAc,CAAC,CAAC;IAChBc,aAAa,CAAC,IAAI,CAAC;EACrB,CAAC,EAAE,CAACd,cAAc,EAAEc,aAAa,CAAC,CAAC;EAEnC,MAAMwB,oBAAoB,GAAIC,CAAC,IAAK;IAClC,MAAMxB,UAAU,GAAGwB,CAAC,CAACC,MAAM,CAACb,KAAK;IACjCpD,qBAAqB,CAACwC,UAAU,CAAC;IACjCD,aAAa,CAACC,UAAU,IAAI,IAAI,CAAC;EACnC,CAAC;EAED,MAAM0B,mBAAmB,GAAIC,OAAO,IAAK;IACvChD,kBAAkB,CAACgD,OAAO,CAAC;IAC3B9C,kBAAkB,CAAC;MACjBE,cAAc,EAAE6C,UAAU,CAACD,OAAO,CAACE,aAAa,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC;MAC5DhD,gBAAgB,EAAExC,MAAM,CAAC,IAAIyF,IAAI,CAAC,CAAC,EAAE,YAAY,CAAC;MAClD/C,IAAI,EAAE;IACR,CAAC,CAAC;IACFb,iBAAiB,CAAC,YAAY,CAAC;EACjC,CAAC;EAED,MAAM6D,4BAA4B,GAAIR,CAAC,IAAK;IAC1C,MAAM;MAAES,IAAI;MAAErB;IAAM,CAAC,GAAGY,CAAC,CAACC,MAAM;IAChC5C,kBAAkB,CAACqD,SAAS,KAAK;MAAE,GAAGA,SAAS;MAAE,CAACD,IAAI,GAAGrB;IAAM,CAAC,CAAC,CAAC;EACpE,CAAC;EAED,MAAMuB,qBAAqB,GAAG,MAAOX,CAAC,IAAK;IACzCA,CAAC,CAACY,cAAc,CAAC,CAAC;IAClB,IAAI,CAAC1D,eAAe,EAAE;MAAEoB,KAAK,CAAC,0BAA0B,CAAC;MAAE;IAAQ;IACnE,MAAMZ,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IAClD,MAAMiD,MAAM,GAAGlD,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IAC9C,IAAI,CAACF,KAAK,IAAI,CAACmD,MAAM,EAAE;MAAEvC,KAAK,CAAC,yBAAyB,CAAC;MAAE/B,QAAQ,CAAC,GAAG,CAAC;MAAE;IAAQ;IAClF,IAAI,CAACa,eAAe,CAACE,gBAAgB,IAAI,CAACF,eAAe,CAACG,cAAc,IAAI,CAACH,eAAe,CAACI,IAAI,EAAE;MAAEc,KAAK,CAAC,6BAA6B,CAAC;MAAE;IAAQ;IACnJ,IAAI;MACF,MAAMwC,eAAe,GAAG;QACtBX,OAAO,EAAEjD,eAAe,CAAC6D,UAAU;QACnCC,OAAO,EAAEC,QAAQ,CAACJ,MAAM,CAAC;QACzBvD,gBAAgB,EAAEF,eAAe,CAACE,gBAAgB;QAClDC,cAAc,EAAE6C,UAAU,CAAChD,eAAe,CAACG,cAAc,CAAC;QAC1DC,IAAI,EAAEJ,eAAe,CAACI;MACxB,CAAC;MACD,MAAM5C,KAAK,CAACsG,IAAI,CAAC,GAAG5F,YAAY,oBAAoB,EAAEwF,eAAe,EAAE;QACrE9C,OAAO,EAAE;UAAE,eAAe,EAAE,UAAUN,KAAK;QAAG;MAChD,CAAC,CAAC;MACFY,KAAK,CAAC,qCAAqC,CAAC;MAE5C,IAAIvC,kBAAkB,EAAE;QACtBwC,aAAa,CAACxC,kBAAkB,CAAC;MACnC,CAAC,MAAM;QACLwC,aAAa,CAAC,IAAI,CAAC;MACrB;MAEA,IAAIxC,kBAAkB,EAAE;QACtBU,WAAW,CAAC,WAAW,CAAC;MAC1B,CAAC,MAAM;QACLA,WAAW,CAAC,WAAW,CAAC;MAC1B;MAEAU,kBAAkB,CAAC,IAAI,CAAC;MACxBE,kBAAkB,CAAC;QAAEC,gBAAgB,EAAE,EAAE;QAAEC,cAAc,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAG,CAAC,CAAC;MAC1Eb,iBAAiB,CAAC,OAAO,CAAC;IAC5B,CAAC,CAAC,OAAOwB,GAAG,EAAE;MACZ,IAAIgD,YAAY,GAAG,oBAAoB;MACvC,IAAIhD,GAAG,CAACL,QAAQ,IAAIK,GAAG,CAACL,QAAQ,CAACG,IAAI,EAAE;QACnC,MAAMmD,YAAY,GAAGjD,GAAG,CAACL,QAAQ,CAACG,IAAI;QACtCG,OAAO,CAAC/B,KAAK,CAAC,eAAe,EAAE+E,YAAY,CAAC;QAC5C,IAAIA,YAAY,CAACC,gBAAgB,EAAE;UAAEF,YAAY,GAAGC,YAAY,CAACC,gBAAgB,CAACC,IAAI,CAAC,GAAG,CAAC;QAC3F,CAAC,MAAM,IAAIF,YAAY,CAACG,MAAM,EAAE;UAAEJ,YAAY,GAAGC,YAAY,CAACG,MAAM;QACpE,CAAC,MAAM;UAAEJ,YAAY,GAAGK,IAAI,CAACC,SAAS,CAACL,YAAY,CAAC;QAAE;MAC1D,CAAC,MAAM;QAAED,YAAY,GAAGhD,GAAG,CAACuD,OAAO;MAAE;MACrCpD,KAAK,CAAC,kCAAkC6C,YAAY,EAAE,CAAC;MACvD7E,QAAQ,CAAC6E,YAAY,CAAC;IACxB;EACF,CAAC;EAED,MAAMQ,qBAAqB,GAAGA,CAAA,KAAM;IAClChF,iBAAiB,CAAC,OAAO,CAAC;IAC1BQ,kBAAkB,CAAC,IAAI,CAAC;IACxBE,kBAAkB,CAAC;MAAEC,gBAAgB,EAAE,EAAE;MAAEC,cAAc,EAAE,EAAE;MAAEC,IAAI,EAAE;IAAG,CAAC,CAAC;IAC1ElB,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC;EAED,MAAMsF,YAAY,GAAIC,UAAU,IAAK;IACnC;IACA,IAAI,CAACA,UAAU,EAAE,OAAO,GAAG;IAC3B,IAAI;MACF,OAAO/G,MAAM,CAAC,IAAIyF,IAAI,CAACsB,UAAU,GAAG,WAAW,CAAC,EAAE,YAAY,CAAC;IACjE,CAAC,CAAC,OAAO7B,CAAC,EAAE;MAAE5B,OAAO,CAAC/B,KAAK,CAAC,uBAAuB,EAAEwF,UAAU,EAAE7B,CAAC,CAAC;MAAE,OAAO6B,UAAU;IAAE;EAC1F,CAAC;EAED,oBACE1G,OAAA;IAAK2G,SAAS,EAAC,sBAAsB;IAAAC,QAAA,gBAEnC5G,OAAA;MAAK2G,SAAS,EAAC,cAAc;MAAAC,QAAA,gBAG3B5G,OAAA;QAAI6G,KAAK,EAAE;UAACC,SAAS,EAAE,CAAC;UAAEC,YAAY,EAAE;QAAQ,CAAE;QAAAH,QAAA,EAAC;MAAsB;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,EAE7EjG,KAAK,iBAAIlB,OAAA;QAAG2G,SAAS,EAAC,eAAe;QAAAC,QAAA,EAAE1F;MAAK;QAAA8F,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAGlDnH,OAAA;QAAK2G,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACzB5G,OAAA;UACEoH,OAAO,EAAC,UAAU;UAClBC,KAAK,EAAC,yEAAmE;UAAAT,QAAA,EAC1E;QAED;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACRnH,OAAA;UACEsH,EAAE,EAAC,UAAU;UACbhC,IAAI,EAAC,UAAU;UACfrB,KAAK,EAAErD,kBAAmB;UAC1B2G,QAAQ,EAAE3C,oBAAqB;UAC/B+B,SAAS,EAAC,cAAc;UACxBU,KAAK,EAAC,yEAAmE;UAAAT,QAAA,gBAEzE5G,OAAA;YAAQiE,KAAK,EAAC,EAAE;YAAA2C,QAAA,EAAC;UAAgC;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACzDrG,gBAAgB,gBACfd,OAAA;YAAQwH,QAAQ;YAAAZ,QAAA,EAAC;UAAuB;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,GAEjDzG,SAAS,CAAC+G,GAAG,CAAC/C,CAAC,iBAAK1E,OAAA;YAA4BiE,KAAK,EAAES,CAAC,CAACgD,WAAY;YAAAd,QAAA,EAAElC,CAAC,CAACiD;UAAI,GAA5CjD,CAAC,CAACgD,WAAW;YAAAV,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAwC,CAAE,CACzF;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGNnH,OAAA,CAAAE,SAAA;MAAA0G,QAAA,gBAEE5G,OAAA;QAAK2G,SAAS,EAAC,2BAA2B;QAACE,KAAK,EAAE;UAACC,SAAS,EAAE;QAAQ,CAAE;QAAAF,QAAA,gBACtE5G,OAAA;UACE2G,SAAS,EAAE,cAActF,QAAQ,KAAK,WAAW,GAAG,QAAQ,GAAG,EAAE,EAAG;UACpEuG,OAAO,EAAEA,CAAA,KAAMtG,WAAW,CAAC,WAAW,CAAE;UACxC+F,KAAK,EAAC,0DAA0D;UAAAT,QAAA,EAE/DhG,kBAAkB,GAAG,uBAAuB,GAAG;QAAyB;UAAAoG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnE,CAAC,EAERvG,kBAAkB,iBACjBZ,OAAA;UACE2G,SAAS,EAAE,cAActF,QAAQ,KAAK,WAAW,GAAG,QAAQ,GAAG,EAAE,EAAG;UACpEuG,OAAO,EAAEA,CAAA,KAAMtG,WAAW,CAAC,WAAW,CAAE;UACxC+F,KAAK,EAAC,+DAA4D;UAAAT,QAAA,EACnE;QAED;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CACT;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,EAELnG,eAAe,iBAAIhB,OAAA;QAAK2G,SAAS,EAAC,iBAAiB;QAAAC,QAAA,EAAC;MAAoB;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAG/EnH,OAAA;QAAK6G,KAAK,EAAE;UAAEgB,OAAO,EAAExG,QAAQ,KAAK,WAAW,GAAG,OAAO,GAAG;QAAO,CAAE;QAAAuF,QAAA,GAClErF,cAAc,KAAK,OAAO,IAAI,CAACP,eAAe,iBAC7ChB,OAAA;UAAK2G,SAAS,EAAC,cAAc;UAAAC,QAAA,gBAC3B5G,OAAA;YAAA4G,QAAA,EAAI;UAA8B;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACvCnH,OAAA;YAAK2G,SAAS,EAAC,yBAAyB;YAAAC,QAAA,eACtC5G,OAAA;cAAO2G,SAAS,EAAC,iBAAiB;cAAAC,QAAA,gBAChC5G,OAAA;gBAAA4G,QAAA,eACE5G,OAAA;kBAAA4G,QAAA,gBACE5G,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,EAClB,CAACvG,kBAAkB,iBAAKZ,OAAA;oBAAA4G,QAAA,EAAI;kBAAQ;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAE,eAC3CnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAM;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACb;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eACRnH,OAAA;gBAAA4G,QAAA,EACGjF,iBAAiB,CAACmG,MAAM,GAAG,CAAC,GAC3BnG,iBAAiB,CAAC8F,GAAG,CAACzC,OAAO;kBAAA,IAAA+C,kBAAA,EAAAC,qBAAA;kBAAA,oBAC3BhI,OAAA;oBAAA4G,QAAA,gBACE5G,OAAA;sBAAA4G,QAAA,eACE5G,OAAA;wBACE4H,OAAO,EAAEA,CAAA,KAAM7C,mBAAmB,CAACC,OAAO,CAAE;wBAC5C2B,SAAS,EAAC,uBAAuB;wBACjCU,KAAK,EAAC,+EAA4E;wBAAAT,QAAA,EACnF;sBAED;wBAAAI,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAQ;oBAAC;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACP,CAAC,EACJ,CAACvG,kBAAkB,iBAClBZ,OAAA;sBAAA4G,QAAA,EAAK,EAAAmB,kBAAA,GAAA/C,OAAO,CAACiD,SAAS,cAAAF,kBAAA,wBAAAC,qBAAA,GAAjBD,kBAAA,CAAmBG,QAAQ,cAAAF,qBAAA,uBAA3BA,qBAAA,CAA6BL,IAAI,KAAI;oBAAyB;sBAAAX,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CACzE,eACDnH,OAAA;sBAAA4G,QAAA,EAAK5B,OAAO,CAACY;oBAAU;sBAAAoB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eAC7BnH,OAAA;sBAAA4G,QAAA,EAAKH,YAAY,CAACzB,OAAO,CAACmD,eAAe;oBAAC;sBAAAnB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eAChDnH,OAAA;sBAAA4G,QAAA,EAAK3B,UAAU,CAACD,OAAO,CAACE,aAAa,CAAC,CAACC,OAAO,CAAC,CAAC;oBAAC;sBAAA6B,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eACvDnH,OAAA;sBAAA4G,QAAA,EAAK5B,OAAO,CAAC9B;oBAAM;sBAAA8D,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC;kBAAA,GAhBlBnC,OAAO,CAACY,UAAU;oBAAAoB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAiBvB,CAAC;gBAAA,CACN,CAAC,gBAEFnH,OAAA;kBAAA4G,QAAA,eACE5G,OAAA;oBAAIoI,OAAO,EAAE,CAACxH,kBAAkB,GAAG,CAAC,GAAG,CAAE;oBAACiG,KAAK,EAAE;sBAAEwB,SAAS,EAAE;oBAAS,CAAE;oBAAAzB,QAAA,EAAC;kBAE1E;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACH;cACL;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACI,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CACN,EAGA5F,cAAc,KAAK,YAAY,IAAIQ,eAAe,iBACjD/B,OAAA;UAAK2G,SAAS,EAAC,cAAc;UAAAC,QAAA,gBAC3B5G,OAAA;YAAA4G,QAAA,EAAI;UAA8B;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACvCnH,OAAA;YAAG6G,KAAK,EAAE;cAACC,SAAS,EAAE,OAAO;cAAEC,YAAY,EAAE,QAAQ;cAAEuB,QAAQ,EAAE,QAAQ;cAAEC,KAAK,EAAE;YAAM,CAAE;YAAA3B,QAAA,GAAC,cAC1E,EAACH,YAAY,CAAC1E,eAAe,CAACoG,eAAe,CAAC,EACzD,KAAK,EAAC,YACG,EAAClD,UAAU,CAAClD,eAAe,CAACmD,aAAa,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC;UAAA;YAAA6B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/D,CAAC,eAENnH,OAAA;YAAK2G,SAAS,EAAC,UAAU;YAAAC,QAAA,gBACvB5G,OAAA;cAAK2G,SAAS,EAAC,YAAY;cAAAC,QAAA,gBACzB5G,OAAA;gBAAA4G,QAAA,EAAO;cAAiB;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eAChCnH,OAAA;gBAAOwI,IAAI,EAAC,MAAM;gBAACvE,KAAK,EAAE,MAAMgB,UAAU,CAAClD,eAAe,CAACmD,aAAa,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC,EAAG;gBAACwB,SAAS,EAAC,sBAAsB;gBAAC8B,QAAQ;cAAA;gBAAAzB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjI,CAAC,eACNnH,OAAA;cAAK2G,SAAS,EAAC,YAAY;cAAAC,QAAA,gBACzB5G,OAAA;gBAAA4G,QAAA,EAAO;cAAmB;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eAClCnH,OAAA;gBAAOwI,IAAI,EAAC,MAAM;gBAACvE,KAAK,EAAEwC,YAAY,CAAC1E,eAAe,CAACoG,eAAe,CAAE;gBAACxB,SAAS,EAAC,sBAAsB;gBAAC8B,QAAQ;cAAA;gBAAAzB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eACNnH,OAAA;YAAM0I,QAAQ,EAAElD,qBAAsB;YAACmB,SAAS,EAAC,wBAAwB;YAAAC,QAAA,gBACvE5G,OAAA;cAAK2G,SAAS,EAAC,UAAU;cAAAC,QAAA,gBACvB5G,OAAA;gBAAK2G,SAAS,EAAC,YAAY;gBAAAC,QAAA,gBACzB5G,OAAA;kBACEoH,OAAO,EAAC,kBAAkB;kBAC1BC,KAAK,EAAC,sDAAsD;kBAAAT,QAAA,EAC7D;gBAED;kBAAAI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACRnH,OAAA;kBACEwI,IAAI,EAAC,MAAM;kBACXlB,EAAE,EAAC,kBAAkB;kBACrBhC,IAAI,EAAC,kBAAkB;kBACvBrB,KAAK,EAAEhC,eAAe,CAACE,gBAAiB;kBACxCoF,QAAQ,EAAElC,4BAA6B;kBACvCsD,QAAQ;kBACRhC,SAAS,EAAC,aAAa;kBACvBU,KAAK,EAAC;gBAAsD;kBAAAL,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC7D,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC,eACNnH,OAAA;gBAAK2G,SAAS,EAAC,YAAY;gBAAAC,QAAA,gBACzB5G,OAAA;kBACEoH,OAAO,EAAC,gBAAgB;kBACxBC,KAAK,EAAC,iFAAiF;kBAAAT,QAAA,EACxF;gBAED;kBAAAI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACRnH,OAAA;kBACEwI,IAAI,EAAC,QAAQ;kBACblB,EAAE,EAAC,gBAAgB;kBACnBhC,IAAI,EAAC,gBAAgB;kBACrBrB,KAAK,EAAEhC,eAAe,CAACG,cAAe;kBACtCmF,QAAQ,EAAElC,4BAA6B;kBACvCuD,IAAI,EAAC,MAAM;kBACXD,QAAQ;kBACRhC,SAAS,EAAC,aAAa;kBACvBU,KAAK,EAAC;gBAAiF;kBAAAL,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACxF,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACNnH,OAAA;cAAK2G,SAAS,EAAC,UAAU;cAAAC,QAAA,gBACvB5G,OAAA;gBAAK2G,SAAS,EAAC,YAAY;gBAAAC,QAAA,gBACzB5G,OAAA;kBACEoH,OAAO,EAAC,MAAM;kBACdC,KAAK,EAAC,wFAAkF;kBAAAT,QAAA,EACzF;gBAED;kBAAAI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACRnH,OAAA;kBACEsH,EAAE,EAAC,MAAM;kBACThC,IAAI,EAAC,MAAM;kBACXrB,KAAK,EAAEhC,eAAe,CAACI,IAAK;kBAC5BkF,QAAQ,EAAElC,4BAA6B;kBACvCsD,QAAQ;kBACRhC,SAAS,EAAC,cAAc;kBACxBU,KAAK,EAAC,wFAAkF;kBAAAT,QAAA,gBAExF5G,OAAA;oBAAQiE,KAAK,EAAC,EAAE;oBAAA2C,QAAA,EAAC;kBAAS;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,EAClC5G,mBAAmB,CAACkH,GAAG,CAAC,CAACoB,KAAK,EAAEC,KAAK,kBAAM9I,OAAA;oBAAoBiE,KAAK,EAAE4E,KAAM;oBAAAjC,QAAA,EAAEiC;kBAAK,GAA3BC,KAAK;oBAAA9B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAA+B,CAAE,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC1F,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACN,CAAC,eACNnH,OAAA;gBAAK2G,SAAS,EAAC,YAAY;gBAACE,KAAK,EAAE;kBAAEkC,IAAI,EAAE;gBAAE;cAAE;gBAAA/B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnD,CAAC,eACNnH,OAAA;cAAK2G,SAAS,EAAC,wBAAwB;cAACE,KAAK,EAAE;gBAAEmC,cAAc,EAAE;cAAgB,CAAE;cAAApC,QAAA,gBACjF5G,OAAA;gBACEwI,IAAI,EAAC,QAAQ;gBACb7B,SAAS,EAAC,kBAAkB;gBAC5BiB,OAAO,EAAEpB,qBAAsB;gBAC/Ba,KAAK,EAAC,0EAAuE;gBAAAT,QAAA,EAC9E;cAED;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eACTnH,OAAA;gBACEwI,IAAI,EAAC,QAAQ;gBACb7B,SAAS,EAAC,gBAAgB;gBAC1BU,KAAK,EAAC,mEAAmE;gBAAAT,QAAA,EAC1E;cAED;gBAAAI,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,EAGLvG,kBAAkB,iBACjBZ,OAAA;QAAK6G,KAAK,EAAE;UAAEgB,OAAO,EAAExG,QAAQ,KAAK,WAAW,GAAG,OAAO,GAAG;QAAO,CAAE;QAAAuF,QAAA,EAClE,CAAC5F,eAAe,iBACfhB,OAAA;UAAK2G,SAAS,EAAC,cAAc;UAAAC,QAAA,gBAC3B5G,OAAA;YAAA4G,QAAA,EAAI;UAA2B;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACpCnH,OAAA;YAAK2G,SAAS,EAAC,yBAAyB;YAAAC,QAAA,eACtC5G,OAAA;cAAO2G,SAAS,EAAC,iBAAiB;cAAAC,QAAA,gBAChC5G,OAAA;gBAAA4G,QAAA,eACE5G,OAAA;kBAAA4G,QAAA,gBACE5G,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAU;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACnBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAM;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACfnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAc;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC,eACvBnH,OAAA;oBAAA4G,QAAA,EAAI;kBAAe;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACtB;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACA,CAAC,eACRnH,OAAA;gBAAA4G,QAAA,EACG/E,aAAa,CAACiG,MAAM,GAAG,CAAC,GACvBjG,aAAa,CAAC4F,GAAG,CAACzC,OAAO,IAAI;kBAC3B,MAAMiE,WAAW,GAAIjE,OAAO,CAACkE,YAAY,IAAIlE,OAAO,CAACkE,YAAY,CAAC,CAAC,CAAC,GAChElE,OAAO,CAACkE,YAAY,CAAC,CAAC,CAAC,GACvB,CAAC,CAAC;kBACN,oBACElJ,OAAA;oBAAA4G,QAAA,gBACE5G,OAAA;sBAAA4G,QAAA,EAAK5B,OAAO,CAACY;oBAAU;sBAAAoB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eAC7BnH,OAAA;sBAAA4G,QAAA,EAAKH,YAAY,CAACzB,OAAO,CAACmD,eAAe;oBAAC;sBAAAnB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eAChDnH,OAAA;sBAAA4G,QAAA,EAAK3B,UAAU,CAACD,OAAO,CAACE,aAAa,CAAC,CAACC,OAAO,CAAC,CAAC;oBAAC;sBAAA6B,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eACvDnH,OAAA;sBAAA4G,QAAA,EAAK5B,OAAO,CAAC9B;oBAAM;sBAAA8D,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eACzBnH,OAAA;sBAAA4G,QAAA,EAAKH,YAAY,CAACwC,WAAW,CAAC9G,gBAAgB;oBAAC;sBAAA6E,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC,eACrDnH,OAAA;sBAAA4G,QAAA,EAAKqC,WAAW,CAAC5G,IAAI,IAAI;oBAAG;sBAAA2E,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAK,CAAC;kBAAA,GAN3BnC,OAAO,CAACY,UAAU;oBAAAoB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAOvB,CAAC;gBAET,CAAC,CAAC,gBAEFnH,OAAA;kBAAA4G,QAAA,eACE5G,OAAA;oBAAIoI,OAAO,EAAC,GAAG;oBAACvB,KAAK,EAAE;sBAAEwB,SAAS,EAAE;oBAAS,CAAE;oBAAAzB,QAAA,EAAC;kBAA+C;oBAAAI,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAI;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAClG;cACL;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACI,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MACN;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CACN;IAAA,eACD,CAAC,eAGHnH,OAAA;MACE2G,SAAS,EAAC,sBAAsB;MAChCiB,OAAO,EAAEA,CAAA,KAAMlG,cAAc,CAAC,IAAI,CAAE;MACpC2F,KAAK,EAAC,4BAAyB;MAAAT,QAAA,eAE/B5G,OAAA,CAACH,eAAe;QAACsJ,IAAI,EAAErJ;MAAiB;QAAAkH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrC,CAAC,eAETnH,OAAA,CAACJ,KAAK;MACJwJ,MAAM,EAAE3H,WAAY;MACpB4H,OAAO,EAAEA,CAAA,KAAM3H,cAAc,CAAC,KAAK,CAAE;MACrC4H,MAAM,EAAC,gCAAgC;MACvCC,MAAM,eACJvJ,OAAA;QACE2G,SAAS,EAAC,qCAAqC;QAC/CiB,OAAO,EAAEA,CAAA,KAAMlG,cAAc,CAAC,KAAK,CAAE;QACrC2F,KAAK,EAAC,8BAA8B;QAAAT,QAAA,EACrC;MAED;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CACT;MAAAP,QAAA,gBAED5G,OAAA;QAAA4G,QAAA,EAAG;MAA0E;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eACjFnH,OAAA;QAAI6G,KAAK,EAAE;UAAE2C,WAAW,EAAE,MAAM;UAAEC,UAAU,EAAE;QAAM,CAAE;QAAA7C,QAAA,gBACpD5G,OAAA;UAAA4G,QAAA,gBACE5G,OAAA;YAAA4G,QAAA,EAAQ;UAAY;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,yGAC/B;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACLnH,OAAA;UAAA4G,QAAA,gBACE5G,OAAA;YAAA4G,QAAA,EAAQ;UAAqB;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,kKACxC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACLnH,OAAA;UAAA4G,QAAA,gBACE5G,OAAA;YAAA4G,QAAA,EAAQ;UAAoB;YAAAI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,sGACvC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAEL,CAAC;AAEV;AAAC1G,EAAA,CA5fQD,UAAU;EAAA,QAOAd,WAAW;AAAA;AAAAgK,EAAA,GAPrBlJ,UAAU;AA8fnB,eAAeA,UAAU;AAAC,IAAAkJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}