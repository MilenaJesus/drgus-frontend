{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\milen\\\\Desktop\\\\4\\xBA ano\\\\projeto\\\\ProjetoDrGus\\\\frontend\\\\src\\\\paginas\\\\Agenda.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport './Agenda.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faChevronLeft, faChevronRight, faPlus } from '@fortawesome/free-solid-svg-icons';\nimport { useNavigate } from 'react-router-dom';\nimport { format, parseISO, isSameDay, startOfWeek, addDays } from 'date-fns';\nimport ptBR from 'date-fns/locale/pt-BR';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = 'http://localhost:8000';\n\n// Funções auxiliares\nconst getDayName = dayIndex => {\n  const days = ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'];\n  return days[dayIndex];\n};\nconst getWeekDays = date => {\n  // startOfWeek considera domingo como início, ajustamos para segunda\n  const start = startOfWeek(date, {\n    weekStartsOn: 1\n  });\n  const weekDays = [];\n  for (let i = 0; i < 7; i++) {\n    weekDays.push(addDays(start, i));\n  }\n  return weekDays;\n};\nconst isSameWeek = (date1, date2) => {\n  const start1 = startOfWeek(date1, {\n    weekStartsOn: 1\n  });\n  const start2 = startOfWeek(date2, {\n    weekStartsOn: 1\n  });\n  return isSameDay(start1, start2);\n};\nconst horarios = Array.from({\n  length: 20\n}, (_, i) => {\n  // Gera das 08:00 às 17:30\n  const hora = 8 + Math.floor(i / 2);\n  const minuto = i % 2 === 0 ? '00' : '30';\n  return `${hora.toString().padStart(2, '0')}:${minuto}`;\n});\nfunction Agenda() {\n  _s();\n  var _selectedAgendamento$;\n  // --- Estados ---\n  const [agendamentos, setAgendamentos] = useState([]);\n  const [view, setView] = useState('semanal'); // 'semanal' ou 'diaria'\n  const [dataAtual, setDataAtual] = useState(new Date()); // Data de referência para a view\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showForm, setShowForm] = useState(false); // Modal de criação\n  const [novoAgendamento, setNovoAgendamento] = useState({\n    paciente: '',\n    data_consulta: '',\n    horario_consulta: ''\n  });\n  const [showDetailModal, setShowDetailModal] = useState(false); // Modal de detalhes\n  const [selectedAgendamento, setSelectedAgendamento] = useState(null);\n  const [selectedPaciente, setSelectedPaciente] = useState(null);\n  const [newStatus, setNewStatus] = useState(''); // Status no modal de detalhes\n  const [modalView, setModalView] = useState('details'); // 'details' ou 'confirmDelete'\n  const [pacientes, setPacientes] = useState([]);\n  const navigate = useNavigate();\n  const [isCurrentWeek, setIsCurrentWeek] = useState(true);\n\n  // --- useEffects e Funções de Busca ---\n  useEffect(() => {\n    setIsCurrentWeek(isSameWeek(dataAtual, new Date()));\n  }, [dataAtual]);\n  const fetchAgendamentos = useCallback(async () => {\n    // setLoading(true); // Evita loading piscando a cada ação\n    setError(null);\n    try {\n      const token = localStorage.getItem('access_token');\n      if (!token) throw new Error('Token de autenticação não encontrado.');\n\n      // Busca todos os agendamentos (simplificado)\n      const response = await axios.get(`${API_BASE_URL}/api/agendamentos/`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      let agendamentosData = response.data.results || response.data || [];\n      if (!Array.isArray(agendamentosData)) {\n        console.error(\"API não retornou um array:\", agendamentosData);\n        agendamentosData = []; // Garante que seja um array\n        setError('Formato de dados inesperado da API.');\n      }\n      setAgendamentos(agendamentosData);\n    } catch (err) {\n      if (err.response && err.response.status === 401) {\n        alert('Sessão expirou...');\n        navigate('/login');\n      } else {\n        setError('Não foi possível carregar os agendamentos.');\n        console.error('Erro agendamentos:', err);\n      }\n    } /* finally { setLoading(false); } */\n  }, [navigate]);\n  const fetchPacientes = useCallback(async () => {\n    setError(null);\n    try {\n      const token = localStorage.getItem('access_token');\n      if (!token) throw new Error('Token de autenticação não encontrado.');\n      const response = await axios.get(`${API_BASE_URL}/api/pacientes/`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setPacientes(response.data.results || response.data || []);\n    } catch (err) {\n      console.error('Erro pacientes:', err);\n      setError(\"Falha ao carregar pacientes\");\n    }\n  }, []); // navigate não é dependência aqui\n\n  useEffect(() => {\n    setLoading(true); // Loading inicial\n    const initData = async () => {\n      await Promise.all([fetchAgendamentos(), fetchPacientes()]);\n      setLoading(false); // Desliga loading após ambas terminarem\n    };\n    initData();\n  }, [fetchAgendamentos, fetchPacientes]); // Dependências corretas\n\n  // --- Handlers ---\n  const handleNavegacaoSemana = dias => {\n    setDataAtual(prevData => addDays(prevData, dias));\n    // Opcional: Chamar fetchAgendamentos() aqui se o backend filtrar por data\n  };\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setNovoAgendamento(prevState => ({\n      ...prevState,\n      [name]: value\n    }));\n  };\n  const handleSubmitAgendamento = async e => {\n    e.preventDefault();\n    try {\n      const token = localStorage.getItem('access_token');\n      const userId = localStorage.getItem('user_id');\n      if (!token || !userId) {\n        alert('Erro de autenticação...');\n        navigate('/');\n        return;\n      }\n      if (!novoAgendamento.paciente) {\n        alert('Selecione um paciente.');\n        return;\n      }\n      const agendamentoData = {\n        paciente: parseInt(novoAgendamento.paciente),\n        usuario: parseInt(userId),\n        data_consulta: novoAgendamento.data_consulta,\n        horario_consulta: novoAgendamento.horario_consulta\n      };\n      await axios.post(`${API_BASE_URL}/api/agendamentos/`, agendamentoData, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      alert('Agendamento criado com sucesso!');\n      setShowForm(false);\n      setNovoAgendamento({\n        paciente: '',\n        data_consulta: '',\n        horario_consulta: ''\n      });\n      fetchAgendamentos(); // Atualiza a lista\n    } catch (err) {\n      // Tratamento de erro detalhado\n      let errorMessage = \"Erro desconhecido.\";\n      if (err.response && err.response.data) {\n        const responseData = err.response.data;\n        console.error('Erro backend:', responseData);\n        if (responseData.non_field_errors) {\n          errorMessage = responseData.non_field_errors.join(' ');\n        } else if (responseData.detail) {\n          errorMessage = responseData.detail;\n        } else if (typeof responseData === 'object') {\n          try {\n            const firstKey = Object.keys(responseData)[0];\n            const firstErrorArray = responseData[firstKey];\n            errorMessage = `${firstKey}: ${Array.isArray(firstErrorArray) ? firstErrorArray.join(' ') : firstErrorArray}`;\n          } catch (parseError) {\n            errorMessage = JSON.stringify(responseData);\n          }\n        } else {\n          errorMessage = JSON.stringify(responseData);\n        }\n      } else {\n        errorMessage = err.message;\n      }\n      alert(`Erro ao criar agendamento: ${errorMessage}`);\n      console.error('Erro completo:', err);\n    }\n  };\n  const handleAppointmentClick = agendamento => {\n    const paciente = pacientes.find(p => p.id_paciente === agendamento.paciente);\n    setSelectedAgendamento(agendamento);\n    setSelectedPaciente(paciente);\n    setNewStatus(agendamento.status || 'pendente');\n    setModalView('details'); // Reseta para view de detalhes\n    setShowDetailModal(true);\n  };\n  const handleSaveStatus = async () => {\n    if (!selectedAgendamento || !newStatus) return;\n    try {\n      const token = localStorage.getItem('access_token');\n      const agendamentoId = selectedAgendamento.id_consulta;\n      const response = await axios.patch(`${API_BASE_URL}/api/agendamentos/${agendamentoId}/`, {\n        status: newStatus\n      }, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setAgendamentos(prev => prev.map(ag => ag.id_consulta === agendamentoId ? response.data : ag));\n      setShowDetailModal(false);\n      setSelectedAgendamento(null);\n      setSelectedPaciente(null);\n    } catch (err) {\n      var _err$response;\n      alert(\"Erro ao atualizar status.\");\n      console.error(\"Erro update:\", ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n    }\n  };\n  const handleDeleteAppointment = async () => {\n    if (!selectedAgendamento) return;\n    // Confirmação via modalView='confirmDelete'\n    try {\n      const token = localStorage.getItem('access_token');\n      const agendamentoId = selectedAgendamento.id_consulta;\n      await axios.delete(`${API_BASE_URL}/api/agendamentos/${agendamentoId}/`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      setAgendamentos(prev => prev.filter(ag => ag.id_consulta !== agendamentoId));\n      setShowDetailModal(false);\n      setSelectedAgendamento(null);\n      setSelectedPaciente(null);\n      alert(\"Consulta excluída.\");\n    } catch (err) {\n      var _err$response2;\n      alert(\"Erro ao excluir.\");\n      console.error(\"Erro delete:\", ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data) || err.message);\n    }\n  };\n  const handleCellClick = (day, hora) => {\n    const dataFormatada = format(day, 'yyyy-MM-dd');\n    const horaFormatada = hora.substring(0, 5);\n    setNovoAgendamento({\n      paciente: '',\n      data_consulta: dataFormatada,\n      horario_consulta: horaFormatada\n    });\n    setShowForm(true);\n  };\n\n  // --- Funções de Renderização ---\n  const renderHeaders = () => {\n    const days = view === 'semanal' ? getWeekDays(dataAtual) : [dataAtual];\n    return days.map(day => /*#__PURE__*/_jsxDEV(\"th\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: getDayName(day.getDay())\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"day-number\",\n        children: format(day, 'dd', {\n          locale: ptBR\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 17\n      }, this), \" \"]\n    }, day.toISOString(), true, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }, this));\n  };\n  const renderCells = hora => {\n    const daysToRender = view === 'semanal' ? getWeekDays(dataAtual) : [dataAtual];\n    const [slotHour, slotMinute] = hora.split(':').map(Number);\n    return daysToRender.map(day => {\n      const slotStart = new Date(day);\n      slotStart.setHours(slotHour, slotMinute, 0, 0);\n      const slotEnd = new Date(slotStart);\n      slotEnd.setMinutes(slotStart.getMinutes() + 30);\n      const agendamentoNoSlot = agendamentos.find(ag => {\n        try {\n          const agendamentoDateISO = ag.data_consulta;\n          const agendamentoDate = parseISO(agendamentoDateISO);\n          if (!isSameDay(agendamentoDate, day)) return false;\n          const [agHour, agMinute] = ag.horario_consulta.split(':').map(Number);\n          const agendamentoStartTime = new Date(agendamentoDate);\n          agendamentoStartTime.setHours(agHour, agMinute, 0, 0);\n          return agendamentoStartTime >= slotStart && agendamentoStartTime < slotEnd;\n        } catch (e) {\n          console.error(\"Erro ao processar agendamento:\", ag, e);\n          return false;\n        }\n      });\n      const paciente = agendamentoNoSlot ? pacientes.find(p => p.id_paciente === agendamentoNoSlot.paciente) : null;\n      return /*#__PURE__*/_jsxDEV(\"td\", {\n        onClick: !paciente ? () => handleCellClick(day, hora) : undefined,\n        className: !paciente ? 'cell-empty' : 'cell-filled',\n        children: paciente && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `appointment-cell status-${agendamentoNoSlot.status || 'pendente'}`,\n          onClick: () => handleAppointmentClick(agendamentoNoSlot),\n          children: [agendamentoNoSlot.horario_consulta.substring(0, 5), \" - \", paciente.nome]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 25\n        }, this)\n      }, day.toISOString() + '-' + hora, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 17\n      }, this);\n    });\n  };\n\n  // --- Renderização Principal ---\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading-message\",\n    children: \"Carregando agenda...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 240,\n    columnNumber: 25\n  }, this);\n  // Removido erro daqui para não duplicar\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"agenda-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"agenda-header-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"date-navigation\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"nav-button\",\n          onClick: () => handleNavegacaoSemana(-7),\n          \"aria-label\": \"Semana anterior\",\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faChevronLeft\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 26\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 22\n        }, this), isCurrentWeek ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"current-week\",\n          children: \"Semana atual\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 26\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"current-week\",\n          children: [format(getWeekDays(dataAtual)[0], 'dd/MM'), \" - \", format(getWeekDays(dataAtual)[6], 'dd/MM', {\n            locale: ptBR\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 26\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"nav-button\",\n          onClick: () => handleNavegacaoSemana(7),\n          \"aria-label\": \"Pr\\xF3xima semana\",\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faChevronRight\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 26\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 22\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"novo-agendamento-button\",\n        onClick: () => setShowForm(true),\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faPlus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 21\n        }, this), \" Nova consulta\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 23\n    }, this), \" \", showForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"nova-consulta-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Nova Consulta\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmitAgendamento,\n        className: \"nova-consulta-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group-compact\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"paciente-novo\",\n            children: \"Nome do Paciente: *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            id: \"paciente-novo\",\n            name: \"paciente\",\n            value: novoAgendamento.paciente,\n            onChange: handleInputChange,\n            className: \"input-field\",\n            required: true,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Selecione um paciente\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 33\n            }, this), pacientes.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: p.id_paciente,\n              children: p.nome\n            }, p.id_paciente, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 54\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group-inline\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group-compact\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"data_consulta-novo\",\n              children: \"Data: *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              id: \"data_consulta-novo\",\n              name: \"data_consulta\",\n              value: novoAgendamento.data_consulta,\n              onChange: handleInputChange,\n              className: \"input-field\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group-compact\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"horario_consulta-novo\",\n              children: \"Hora: *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"time\",\n              id: \"horario_consulta-novo\",\n              name: \"horario_consulta\",\n              value: novoAgendamento.horario_consulta,\n              onChange: handleInputChange,\n              className: \"input-field\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-actions-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"button-secondary\",\n            onClick: () => setShowForm(false),\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"button-primary\",\n            children: \"Salvar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"schedule-options\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"schedule-options-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"horarios-text\",\n          children: \"Hor\\xE1rios\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"separator-text\",\n          children: \"|\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"current-month\",\n          children: format(dataAtual, 'MMMM yyyy', {\n            locale: ptBR\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"view-toggle\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `toggle-button ${view === 'semanal' ? 'active' : ''}`,\n          onClick: () => setView('semanal'),\n          children: \"Semana\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `toggle-button ${view === 'diaria' ? 'active' : ''}`,\n          onClick: () => setView('diaria'),\n          children: \"Dia\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"schedule-table-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"schedule-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              className: \"horario-col\",\n              children: \"Hor\\xE1rio\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 32\n            }, this), renderHeaders()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 28\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: horarios.map(hora => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"horario-col\",\n              children: hora\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 66\n            }, this), renderCells(hora)]\n          }, hora, true, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 51\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"legend-fixed-footer\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-indicator confirmado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 50\n          }, this), \" Confirmado\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-indicator pendente\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 50\n          }, this), \" Pendente\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-indicator cancelado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 50\n          }, this), \" Cancelado\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"legend-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-indicator reagendado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 50\n          }, this), \" Reagendado\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 14\n    }, this), showDetailModal && selectedAgendamento && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-backdrop\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: modalView === 'details' ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Detalhes da Consulta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Paciente:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 36\n            }, this), \" \", (selectedPaciente === null || selectedPaciente === void 0 ? void 0 : selectedPaciente.nome) || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Data:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 36\n            }, this), \" \", selectedAgendamento.data_consulta ? format(parseISO(selectedAgendamento.data_consulta), 'dd/MM/yyyy', {\n              locale: ptBR\n            }) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Hora:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 36\n            }, this), \" \", ((_selectedAgendamento$ = selectedAgendamento.horario_consulta) === null || _selectedAgendamento$ === void 0 ? void 0 : _selectedAgendamento$.substring(0, 5)) || '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group-compact\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"status-edit\",\n              children: \"Alterar Status:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"status-edit\",\n              className: \"input-field\",\n              value: newStatus,\n              onChange: e => setNewStatus(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"pendente\",\n                children: \"Pendente\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"confirmado\",\n                children: \"Confirmado\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"cancelado\",\n                children: \"Cancelado\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"reagendado\",\n                children: \"Reagendado\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-actions-footer\",\n            style: {\n              justifyContent: 'space-between',\n              marginTop: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"button-danger\",\n              onClick: () => setModalView('confirmDelete'),\n              children: \"Excluir\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"button-secondary\",\n                onClick: () => setShowDetailModal(false),\n                children: \"Fechar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"button-primary\",\n                onClick: handleSaveStatus,\n                style: {\n                  marginLeft: '10px'\n                },\n                children: \"Salvar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true) :\n        /*#__PURE__*/\n        /* Confirmação de Exclusão */\n        _jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Confirmar Exclus\\xE3o\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Tem certeza que deseja excluir esta consulta?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: '0.9rem',\n              color: '#666'\n            },\n            children: \"Esta a\\xE7\\xE3o n\\xE3o pode ser desfeita.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-actions-footer\",\n            style: {\n              justifyContent: 'flex-end',\n              marginTop: '2rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"button-secondary\",\n              onClick: () => setModalView('details'),\n              children: \"Cancelar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"button-danger\",\n              onClick: handleDeleteAppointment,\n              style: {\n                marginLeft: '10px'\n              },\n              children: \"Sim, Excluir\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 244,\n    columnNumber: 9\n  }, this);\n}\n_s(Agenda, \"EF/xgDgLTKmZP3N782d8yVVwfyk=\", false, function () {\n  return [useNavigate];\n});\n_c = Agenda;\nexport default Agenda;\nvar _c;\n$RefreshReg$(_c, \"Agenda\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","FontAwesomeIcon","faChevronLeft","faChevronRight","faPlus","useNavigate","format","parseISO","isSameDay","startOfWeek","addDays","ptBR","jsxDEV","_jsxDEV","Fragment","_Fragment","API_BASE_URL","getDayName","dayIndex","days","getWeekDays","date","start","weekStartsOn","weekDays","i","push","isSameWeek","date1","date2","start1","start2","horarios","Array","from","length","_","hora","Math","floor","minuto","toString","padStart","Agenda","_s","_selectedAgendamento$","agendamentos","setAgendamentos","view","setView","dataAtual","setDataAtual","Date","loading","setLoading","error","setError","showForm","setShowForm","novoAgendamento","setNovoAgendamento","paciente","data_consulta","horario_consulta","showDetailModal","setShowDetailModal","selectedAgendamento","setSelectedAgendamento","selectedPaciente","setSelectedPaciente","newStatus","setNewStatus","modalView","setModalView","pacientes","setPacientes","navigate","isCurrentWeek","setIsCurrentWeek","fetchAgendamentos","token","localStorage","getItem","Error","response","get","headers","agendamentosData","data","results","isArray","console","err","status","alert","fetchPacientes","initData","Promise","all","handleNavegacaoSemana","dias","prevData","handleInputChange","e","name","value","target","prevState","handleSubmitAgendamento","preventDefault","userId","agendamentoData","parseInt","usuario","post","errorMessage","responseData","non_field_errors","join","detail","firstKey","Object","keys","firstErrorArray","parseError","JSON","stringify","message","handleAppointmentClick","agendamento","find","p","id_paciente","handleSaveStatus","agendamentoId","id_consulta","patch","prev","map","ag","_err$response","handleDeleteAppointment","delete","filter","_err$response2","handleCellClick","day","dataFormatada","horaFormatada","substring","renderHeaders","children","getDay","fileName","_jsxFileName","lineNumber","columnNumber","className","locale","toISOString","renderCells","daysToRender","slotHour","slotMinute","split","Number","slotStart","setHours","slotEnd","setMinutes","getMinutes","agendamentoNoSlot","agendamentoDateISO","agendamentoDate","agHour","agMinute","agendamentoStartTime","onClick","undefined","nome","icon","onSubmit","htmlFor","id","onChange","required","type","style","justifyContent","marginTop","marginLeft","fontSize","color","_c","$RefreshReg$"],"sources":["C:/Users/milen/Desktop/4º ano/projeto/ProjetoDrGus/frontend/src/paginas/Agenda.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport './Agenda.css';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faChevronLeft, faChevronRight, faPlus } from '@fortawesome/free-solid-svg-icons';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { format, parseISO, isSameDay, startOfWeek, addDays } from 'date-fns';\r\nimport ptBR from 'date-fns/locale/pt-BR'; \r\n\r\nconst API_BASE_URL = 'http://localhost:8000';\r\n\r\n// Funções auxiliares\r\nconst getDayName = (dayIndex) => {\r\n    const days = ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'];\r\n    return days[dayIndex];\r\n};\r\nconst getWeekDays = (date) => {\r\n    // startOfWeek considera domingo como início, ajustamos para segunda\r\n    const start = startOfWeek(date, { weekStartsOn: 1 });\r\n    const weekDays = [];\r\n    for (let i = 0; i < 7; i++) {\r\n        weekDays.push(addDays(start, i));\r\n    }\r\n    return weekDays;\r\n};\r\nconst isSameWeek = (date1, date2) => {\r\n    const start1 = startOfWeek(date1, { weekStartsOn: 1 });\r\n    const start2 = startOfWeek(date2, { weekStartsOn: 1 });\r\n    return isSameDay(start1, start2);\r\n};\r\nconst horarios = Array.from({ length: 20 }, (_, i) => { // Gera das 08:00 às 17:30\r\n    const hora = 8 + Math.floor(i / 2);\r\n    const minuto = i % 2 === 0 ? '00' : '30';\r\n    return `${hora.toString().padStart(2, '0')}:${minuto}`;\r\n});\r\n\r\n\r\nfunction Agenda() {\r\n    // --- Estados ---\r\n    const [agendamentos, setAgendamentos] = useState([]);\r\n    const [view, setView] = useState('semanal'); // 'semanal' ou 'diaria'\r\n    const [dataAtual, setDataAtual] = useState(new Date()); // Data de referência para a view\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [showForm, setShowForm] = useState(false); // Modal de criação\r\n    const [novoAgendamento, setNovoAgendamento] = useState({ paciente: '', data_consulta: '', horario_consulta: '' });\r\n    const [showDetailModal, setShowDetailModal] = useState(false); // Modal de detalhes\r\n    const [selectedAgendamento, setSelectedAgendamento] = useState(null);\r\n    const [selectedPaciente, setSelectedPaciente] = useState(null);\r\n    const [newStatus, setNewStatus] = useState(''); // Status no modal de detalhes\r\n    const [modalView, setModalView] = useState('details'); // 'details' ou 'confirmDelete'\r\n    const [pacientes, setPacientes] = useState([]);\r\n    const navigate = useNavigate();\r\n    const [isCurrentWeek, setIsCurrentWeek] = useState(true);\r\n\r\n    // --- useEffects e Funções de Busca ---\r\n    useEffect(() => { setIsCurrentWeek(isSameWeek(dataAtual, new Date())); }, [dataAtual]);\r\n\r\n    const fetchAgendamentos = useCallback(async () => {\r\n        // setLoading(true); // Evita loading piscando a cada ação\r\n        setError(null);\r\n        try {\r\n            const token = localStorage.getItem('access_token');\r\n            if (!token) throw new Error('Token de autenticação não encontrado.');\r\n\r\n            // Busca todos os agendamentos (simplificado)\r\n            const response = await axios.get(`${API_BASE_URL}/api/agendamentos/`, {\r\n                 headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n            let agendamentosData = response.data.results || response.data || [];\r\n            if (!Array.isArray(agendamentosData)) {\r\n                 console.error(\"API não retornou um array:\", agendamentosData);\r\n                 agendamentosData = []; // Garante que seja um array\r\n                 setError('Formato de dados inesperado da API.');\r\n            }\r\n             setAgendamentos(agendamentosData);\r\n        } catch (err) {\r\n            if (err.response && err.response.status === 401) { alert('Sessão expirou...'); navigate('/login'); }\r\n            else { setError('Não foi possível carregar os agendamentos.'); console.error('Erro agendamentos:', err); }\r\n        } /* finally { setLoading(false); } */\r\n    }, [navigate]);\r\n\r\n    const fetchPacientes = useCallback(async () => {\r\n        setError(null);\r\n        try {\r\n            const token = localStorage.getItem('access_token');\r\n            if (!token) throw new Error('Token de autenticação não encontrado.');\r\n            const response = await axios.get(`${API_BASE_URL}/api/pacientes/`, {\r\n                 headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n             setPacientes(response.data.results || response.data || []);\r\n        } catch (err) { console.error('Erro pacientes:', err); setError(\"Falha ao carregar pacientes\");}\r\n    }, []); // navigate não é dependência aqui\r\n\r\n     useEffect(() => {\r\n         setLoading(true); // Loading inicial\r\n         const initData = async () => {\r\n             await Promise.all([\r\n                 fetchAgendamentos(),\r\n                 fetchPacientes()\r\n             ]);\r\n             setLoading(false); // Desliga loading após ambas terminarem\r\n         };\r\n         initData();\r\n     }, [fetchAgendamentos, fetchPacientes]); // Dependências corretas\r\n\r\n\r\n    // --- Handlers ---\r\n    const handleNavegacaoSemana = (dias) => {\r\n        setDataAtual(prevData => addDays(prevData, dias));\r\n        // Opcional: Chamar fetchAgendamentos() aqui se o backend filtrar por data\r\n    };\r\n\r\n    const handleInputChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setNovoAgendamento(prevState => ({ ...prevState, [name]: value }));\r\n    };\r\n\r\n    const handleSubmitAgendamento = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const token = localStorage.getItem('access_token'); const userId = localStorage.getItem('user_id');\r\n            if (!token || !userId) { alert('Erro de autenticação...'); navigate('/'); return; }\r\n            if (!novoAgendamento.paciente) { alert('Selecione um paciente.'); return; }\r\n\r\n            const agendamentoData = {\r\n                paciente: parseInt(novoAgendamento.paciente),\r\n                usuario: parseInt(userId),\r\n                data_consulta: novoAgendamento.data_consulta,\r\n                horario_consulta: novoAgendamento.horario_consulta,\r\n            };\r\n\r\n            await axios.post(`${API_BASE_URL}/api/agendamentos/`, agendamentoData, { headers: { 'Authorization': `Bearer ${token}` } });\r\n\r\n            alert('Agendamento criado com sucesso!');\r\n            setShowForm(false);\r\n            setNovoAgendamento({ paciente: '', data_consulta: '', horario_consulta: '' });\r\n            fetchAgendamentos(); // Atualiza a lista\r\n        } catch (err) {\r\n            // Tratamento de erro detalhado\r\n            let errorMessage = \"Erro desconhecido.\";\r\n             if (err.response && err.response.data) { const responseData = err.response.data; console.error('Erro backend:', responseData); if (responseData.non_field_errors) { errorMessage = responseData.non_field_errors.join(' '); } else if (responseData.detail) { errorMessage = responseData.detail; } else if (typeof responseData === 'object') { try { const firstKey = Object.keys(responseData)[0]; const firstErrorArray = responseData[firstKey]; errorMessage = `${firstKey}: ${Array.isArray(firstErrorArray) ? firstErrorArray.join(' ') : firstErrorArray}`; } catch (parseError){ errorMessage = JSON.stringify(responseData); } } else { errorMessage = JSON.stringify(responseData); } } else { errorMessage = err.message; } alert(`Erro ao criar agendamento: ${errorMessage}`); console.error('Erro completo:', err);\r\n        }\r\n    };\r\n\r\n    const handleAppointmentClick = (agendamento) => {\r\n        const paciente = pacientes.find(p => p.id_paciente === agendamento.paciente);\r\n        setSelectedAgendamento(agendamento);\r\n        setSelectedPaciente(paciente);\r\n        setNewStatus(agendamento.status || 'pendente');\r\n        setModalView('details'); // Reseta para view de detalhes\r\n        setShowDetailModal(true);\r\n    };\r\n\r\n    const handleSaveStatus = async () => {\r\n        if (!selectedAgendamento || !newStatus) return;\r\n        try {\r\n            const token = localStorage.getItem('access_token');\r\n            const agendamentoId = selectedAgendamento.id_consulta;\r\n            const response = await axios.patch(`${API_BASE_URL}/api/agendamentos/${agendamentoId}/`, { status: newStatus }, { headers: { 'Authorization': `Bearer ${token}` } });\r\n            setAgendamentos(prev => prev.map(ag => ag.id_consulta === agendamentoId ? response.data : ag));\r\n            setShowDetailModal(false); setSelectedAgendamento(null); setSelectedPaciente(null);\r\n        } catch (err) { alert(\"Erro ao atualizar status.\"); console.error(\"Erro update:\", err.response?.data || err.message); }\r\n    };\r\n\r\n    const handleDeleteAppointment = async () => {\r\n        if (!selectedAgendamento) return;\r\n        // Confirmação via modalView='confirmDelete'\r\n        try {\r\n            const token = localStorage.getItem('access_token'); const agendamentoId = selectedAgendamento.id_consulta;\r\n            await axios.delete(`${API_BASE_URL}/api/agendamentos/${agendamentoId}/`, { headers: { 'Authorization': `Bearer ${token}` } });\r\n            setAgendamentos(prev => prev.filter(ag => ag.id_consulta !== agendamentoId));\r\n            setShowDetailModal(false); setSelectedAgendamento(null); setSelectedPaciente(null);\r\n            alert(\"Consulta excluída.\");\r\n        } catch (err) { alert(\"Erro ao excluir.\"); console.error(\"Erro delete:\", err.response?.data || err.message); }\r\n    };\r\n\r\n    const handleCellClick = (day, hora) => {\r\n        const dataFormatada = format(day, 'yyyy-MM-dd');\r\n        const horaFormatada = hora.substring(0, 5);\r\n        setNovoAgendamento({ paciente: '', data_consulta: dataFormatada, horario_consulta: horaFormatada });\r\n        setShowForm(true);\r\n    };\r\n\r\n    // --- Funções de Renderização ---\r\n    const renderHeaders = () => {\r\n        const days = view === 'semanal' ? getWeekDays(dataAtual) : [dataAtual];\r\n        return days.map(day => (\r\n            <th key={day.toISOString()}>\r\n                <div>{getDayName(day.getDay())}</div>\r\n                <div className=\"day-number\">{format(day, 'dd', { locale: ptBR })}</div> {/* ptBR */}\r\n            </th>\r\n        ));\r\n    };\r\n\r\n    const renderCells = (hora) => {\r\n        const daysToRender = view === 'semanal' ? getWeekDays(dataAtual) : [dataAtual];\r\n        const [slotHour, slotMinute] = hora.split(':').map(Number);\r\n\r\n        return daysToRender.map(day => {\r\n            const slotStart = new Date(day); slotStart.setHours(slotHour, slotMinute, 0, 0);\r\n            const slotEnd = new Date(slotStart); slotEnd.setMinutes(slotStart.getMinutes() + 30);\r\n\r\n            const agendamentoNoSlot = agendamentos.find(ag => {\r\n                try {\r\n                     const agendamentoDateISO = ag.data_consulta;\r\n                     const agendamentoDate = parseISO(agendamentoDateISO);\r\n                     if(!isSameDay(agendamentoDate, day)) return false;\r\n\r\n                     const [agHour, agMinute] = ag.horario_consulta.split(':').map(Number);\r\n                     const agendamentoStartTime = new Date(agendamentoDate);\r\n                     agendamentoStartTime.setHours(agHour, agMinute, 0, 0);\r\n\r\n                     return agendamentoStartTime >= slotStart && agendamentoStartTime < slotEnd;\r\n                } catch(e) { console.error(\"Erro ao processar agendamento:\", ag, e); return false; }\r\n            });\r\n\r\n            const paciente = agendamentoNoSlot ? pacientes.find(p => p.id_paciente === agendamentoNoSlot.paciente) : null;\r\n\r\n            return (\r\n                <td\r\n                    key={day.toISOString() + '-' + hora}\r\n                    onClick={!paciente ? () => handleCellClick(day, hora) : undefined}\r\n                    className={!paciente ? 'cell-empty' : 'cell-filled'}\r\n                >\r\n                    {paciente && (\r\n                        <div\r\n                            className={`appointment-cell status-${agendamentoNoSlot.status || 'pendente'}`}\r\n                            onClick={() => handleAppointmentClick(agendamentoNoSlot)}\r\n                        >\r\n                            {agendamentoNoSlot.horario_consulta.substring(0, 5)} - {paciente.nome}\r\n                        </div>\r\n                    )}\r\n                </td>\r\n            );\r\n        });\r\n    };\r\n\r\n    // --- Renderização Principal ---\r\n    if (loading) return <div className=\"loading-message\">Carregando agenda...</div>;\r\n    // Removido erro daqui para não duplicar\r\n\r\n    return (\r\n        <div className=\"agenda-container\">\r\n            {/* Cabeçalho */}\r\n            <div className=\"agenda-header-content\">\r\n                 <div className=\"date-navigation\">\r\n                     <button className=\"nav-button\" onClick={() => handleNavegacaoSemana(-7)} aria-label=\"Semana anterior\">\r\n                         <FontAwesomeIcon icon={faChevronLeft} />\r\n                     </button>\r\n                     {isCurrentWeek ? (\r\n                         <span className=\"current-week\">Semana atual</span>\r\n                     ) : (\r\n                         <span className=\"current-week\">\r\n                             {format(getWeekDays(dataAtual)[0], 'dd/MM')} - {format(getWeekDays(dataAtual)[6], 'dd/MM', { locale: ptBR })}\r\n                         </span>\r\n                     )}\r\n                     <button className=\"nav-button\" onClick={() => handleNavegacaoSemana(7)} aria-label=\"Próxima semana\">\r\n                         <FontAwesomeIcon icon={faChevronRight} />\r\n                     </button>\r\n                 </div>\r\n                <button className=\"novo-agendamento-button\" onClick={() => setShowForm(true)}>\r\n                    <FontAwesomeIcon icon={faPlus} /> Nova consulta\r\n                </button>\r\n            </div>\r\n            {error && <p className=\"error-message\">{error}</p>} {/* Mostra erro geral aqui */}\r\n\r\n\r\n            {/* Modal/Formulário de Nova Consulta (COM ASTERISCOS) */}\r\n            {showForm && (\r\n                <div className=\"nova-consulta-card\">\r\n                    <h3>Nova Consulta</h3>\r\n                    <form onSubmit={handleSubmitAgendamento} className=\"nova-consulta-form\">\r\n                        <div className=\"form-group-compact\">\r\n                            <label htmlFor=\"paciente-novo\">Nome do Paciente: *</label>\r\n                            <select id=\"paciente-novo\" name=\"paciente\" value={novoAgendamento.paciente} onChange={handleInputChange} className=\"input-field\" required>\r\n                                <option value=\"\">Selecione um paciente</option>\r\n                                {pacientes.map(p => (<option key={p.id_paciente} value={p.id_paciente}>{p.nome}</option>))}\r\n                            </select>\r\n                        </div>\r\n                        <div className=\"form-group-inline\">\r\n                            <div className=\"form-group-compact\">\r\n                                <label htmlFor=\"data_consulta-novo\">Data: *</label>\r\n                                <input type=\"date\" id=\"data_consulta-novo\" name=\"data_consulta\" value={novoAgendamento.data_consulta} onChange={handleInputChange} className=\"input-field\" required />\r\n                            </div>\r\n                            <div className=\"form-group-compact\">\r\n                                <label htmlFor=\"horario_consulta-novo\">Hora: *</label>\r\n                                <input type=\"time\" id=\"horario_consulta-novo\" name=\"horario_consulta\" value={novoAgendamento.horario_consulta} onChange={handleInputChange} className=\"input-field\" required />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"form-actions-footer\">\r\n                            <button type=\"button\" className=\"button-secondary\" onClick={() => setShowForm(false)}>Cancelar</button>\r\n                            <button type=\"submit\" className=\"button-primary\">Salvar</button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            )}\r\n\r\n            {/* Opções de View e Tabela */}\r\n            <div className=\"schedule-options\">\r\n                <div className=\"schedule-options-left\">\r\n                    <span className=\"horarios-text\">Horários</span>\r\n                    <span className=\"separator-text\">|</span>\r\n                    <span className=\"current-month\">{format(dataAtual, 'MMMM yyyy', { locale: ptBR })}</span>\r\n                </div>\r\n                <div className=\"view-toggle\">\r\n                    <button className={`toggle-button ${view === 'semanal' ? 'active' : ''}`} onClick={() => setView('semanal')}>Semana</button>\r\n                    <button className={`toggle-button ${view === 'diaria' ? 'active' : ''}`} onClick={() => setView('diaria')}>Dia</button>\r\n                </div>\r\n            </div>\r\n            <div className=\"schedule-table-wrapper\">\r\n                <table className=\"schedule-table\">\r\n                    <thead><tr><th className=\"horario-col\">Horário</th>{renderHeaders()}</tr></thead>\r\n                    <tbody>{horarios.map(hora => (<tr key={hora}><td className=\"horario-col\">{hora}</td>{renderCells(hora)}</tr>))}</tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* Legenda */}\r\n             <div className=\"legend-fixed-footer\">\r\n                <div className=\"legend\">\r\n                    <div className=\"legend-item\"><span className=\"status-indicator confirmado\"></span> Confirmado</div>\r\n                    <div className=\"legend-item\"><span className=\"status-indicator pendente\"></span> Pendente</div>\r\n                    <div className=\"legend-item\"><span className=\"status-indicator cancelado\"></span> Cancelado</div>\r\n                    <div className=\"legend-item\"><span className=\"status-indicator reagendado\"></span> Reagendado</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Modal de Detalhes / Edição / Exclusão */}\r\n            {showDetailModal && selectedAgendamento && (\r\n                <div className=\"modal-backdrop\">\r\n                    <div className=\"modal-content\">\r\n                        {modalView === 'details' ? (\r\n                           <> {/* Detalhes */}\r\n                                <h3>Detalhes da Consulta</h3>\r\n                                <p><strong>Paciente:</strong> {selectedPaciente?.nome || 'N/A'}</p>\r\n                                <p><strong>Data:</strong> {selectedAgendamento.data_consulta ? format(parseISO(selectedAgendamento.data_consulta), 'dd/MM/yyyy', { locale: ptBR }) : '-'}</p>\r\n                                <p><strong>Hora:</strong> {selectedAgendamento.horario_consulta?.substring(0, 5) || '-'}</p>\r\n                                <div className=\"form-group-compact\">\r\n                                    <label htmlFor=\"status-edit\">Alterar Status:</label>\r\n                                    <select id=\"status-edit\" className=\"input-field\" value={newStatus} onChange={(e) => setNewStatus(e.target.value)}>\r\n                                        <option value=\"pendente\">Pendente</option>\r\n                                        <option value=\"confirmado\">Confirmado</option>\r\n                                        <option value=\"cancelado\">Cancelado</option>\r\n                                        <option value=\"reagendado\">Reagendado</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div className=\"form-actions-footer\" style={{ justifyContent: 'space-between', marginTop: '2rem' }}>\r\n                                    <button type=\"button\" className=\"button-danger\" onClick={() => setModalView('confirmDelete')}>Excluir</button>\r\n                                    <div>\r\n                                        <button type=\"button\" className=\"button-secondary\" onClick={() => setShowDetailModal(false)}>Fechar</button>\r\n                                        <button type=\"button\" className=\"button-primary\" onClick={handleSaveStatus} style={{ marginLeft: '10px' }}>Salvar</button>\r\n                                    </div>\r\n                                </div>\r\n                           </>\r\n                        ) : ( /* Confirmação de Exclusão */\r\n                           <>\r\n                                <h3>Confirmar Exclusão</h3>\r\n                                <p>Tem certeza que deseja excluir esta consulta?</p>\r\n                                <p style={{ fontSize: '0.9rem', color: '#666' }}>Esta ação não pode ser desfeita.</p>\r\n                                <div className=\"form-actions-footer\" style={{ justifyContent: 'flex-end', marginTop: '2rem' }}>\r\n                                    <button type=\"button\" className=\"button-secondary\" onClick={() => setModalView('details')}>Cancelar</button>\r\n                                    <button type=\"button\" className=\"button-danger\" onClick={handleDeleteAppointment} style={{ marginLeft: '10px' }}>Sim, Excluir</button>\r\n                                </div>\r\n                           </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Agenda;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}